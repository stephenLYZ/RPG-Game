!function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="./",e(0)}([function(t,e,i){var n=i(1);window.onload=n()},function(t,e,i){i(2);var n=i(3),s=n.mapData,r=n.foregroundData,a=function(){enchant();var t=new Game(300,300);t.keybind(32,"a"),t.spriteSheetWidth=256,t.spriteSheetHeight=16,t.itemSpriteSheetWidth=64,t.fps=15,t.spriteWidth=16,t.spriteHeight=16,t.preload(["sprites.png","items.png"]),t.items=[{price:100,description:"Hurter",id:0},{price:300,description:"Drg. Paw",id:1},{price:300,description:"Ice Magic",id:2},{price:60,description:"Chess Set",id:3}];var e=new Map(t.spriteWidth,t.spriteHeight),i=new Map(t.spriteWidth,t.spriteHeight),n=function(){e.image=t.assets["sprites.png"],e.loadData(s),i.image=t.assets["sprites.png"],i.loadData(r);for(var n=[],a=0;a<r.length;a++){n.push([]);for(var o=0;o<r[0].length;o++){var h=r[a][o]%13>1?1:0;n[a][o]=h}}e.collisionData=n},a=function(){var n=new Group;n.addChild(e),n.addChild(o),n.addChild(i),n.addChild(o.statusLabel),t.rootScene.addChild(n)},o=new Sprite(t.spriteWidth,t.spriteHeight),h=function(){o.spriteOffset=5,o.startingX=6,o.startingY=14,o.x=o.startingX*t.spriteWidth,o.y=o.startingY*t.spriteHeight,o.direction=0,o.walk=0,o.frame=o.spriteOffset+2*o.direction,o.image=new Surface(t.spriteSheetWidth,t.spriteSheetHeight),o.image.draw(t.assets["sprites.png"]),o.name="Stephen",o.characterClass="Warrior",o.exp=0,o.level=1,o.gp=100,window.localStorage.getItem("exp")?o.exp=parseInt(window.localStorage.getItem("exp")):o.exp=0,window.localStorage.getItem("level")?o.level=parseInt(window.localStorage.getItem("level")):o.level=1,window.localStorage.getItem("gp")?o.gp=parseInt(window.localStorage.getItem("gp")):o.gp=100,window.localStorage.getItem("inventory")?o.inventory=JSON.parse(window.localStorage.getItem("inventory")):o.inventory=[],o.levelStats=[{},{attack:4,maxHp:10,maxMp:0,expMax:10},{attack:6,maxHp:14,maxMp:0,expMax:30},{attack:7,maxHp:20,maxMp:5,expMax:50}],o.levelStats=[{},{attack:4,maxHp:10,maxMp:0,expMax:10},{attack:6,maxHp:14,maxMp:0,expMax:30},{attack:7,maxHp:20,maxMp:5,expMax:50}],o.attack=function(){return o.levelStats[o.level].attack},o.hp=o.levelStats[o.level].maxHp,o.mp=o.levelStats[o.level].maxMp,o.statusLabel=new Label(""),o.statusLabel.width=t.width,o.statusLabel.height=80,o.statusLabel.y=void 0,o.statusLabel.x=void 0,o.statusLabel.color="#fff"},c=function(){var e=new Group;e.itemSelected=0,e.shoppingFunds=function(){return"Gold: "+o.gp},e.drawManeki=function(){var e=new Surface(t.spriteSheetWidth,t.spriteSheetHeight),i=new Sprite(t.spriteWidth,t.spriteHeight);i.image=e,e.draw(t.assets["sprites.png"]),i.frame=4,i.y=10,i.x=10,i.scaleX=2,i.scaleY=2,this.addChild(i),this.message.x=40,this.message.y=10,this.message.color="#fff",this.addChild(this.message)},e.drawItemsForSale=function(){for(var e=0;e<t.items.length;e++){var i=new Surface(t.itemSpriteSheetWidth,t.spriteSheetHeight),n=new Sprite(t.spriteWidth,t.spriteHeight);i.draw(t.assets["items.png"]),itemLocationX=30+70*e,itemLocationY=70,n.y=itemLocationY,n.x=itemLocationX,n.frame=e,n.scaleX=2,n.scaleY=2,n.image=i,this.addChild(n);var s=new Label(t.items[e].price+"<br />"+t.items[e].description);if(s.x=itemLocationX-8,s.y=itemLocationY+40,s.color="#fff",this.addChild(s),e===this.itemSelected){var i=new Surface(t.spriteSheetWidth,t.spriteSheetHeight);this.itemSelector=new Sprite(t.spriteWidth,t.spriteHeight),i.draw(t.assets["sprites.png"]),itemLocationX=30+70*e,itemLocationY=160,this.itemSelector.scaleX=2,this.itemSelector.scaleY=2,this.itemSelector.y=itemLocationY,this.itemSelector.x=itemLocationX,this.itemSelector.frame=7,this.itemSelector.image=i,this.addChild(this.itemSelector)}}},e.on("enter",function(){i.text=e.shoppingFunds()}),e.on("enterframe",function(){setTimeout(function(){t.input.a?e.attemptToBuy():t.input.down?(e.message.text=e.farewell,setTimeout(function(){t.popScene(),e.message.text=e.greeting},1e3)):t.input.left?(e.itemSelected=e.itemSelected+t.items.length-1,e.itemSelected=e.itemSelected%t.items.length,e.itemSelector.x=30+70*e.itemSelected,e.message.text=e.greeting):t.input.right&&(e.itemSelected=(e.itemSelected+1)%t.items.length,e.itemSelector.x=30+70*e.itemSelected,e.message.text=e.greeting)},500),o.showInventory(100),i.text=e.shoppingFunds()}),e.attemptToBuy=function(){var e=t.items[this.itemSelected].price;o.gp<e?this.message.text=this.apology:(o.visibleItems=[],o.gp=o.gp-e,o.inventory.push(t.items[this.itemSelected].id),this.message.text=this.sale)},e.greeting="Hi! I'm Maneki. I sell things",e.apology="Meow...Sorry,you don't have the money for this",e.sale="Here ya go!",e.farewell="Come again! Meow!",e.message=new Label(e.greeting),e.drawManeki();var i=new Label(e.shoppingFunds());i.color="#fff",i.y=200,i.x=10,e.addChild(i),e.drawItemsForSale(),f.backgroundColor="#000",f.addChild(e)},l=function(){v.backgroundColor="#000";var e=new Group;e.menu=new Label,e.menu.x=20,e.menu.y=170,e.menu.color="#fff",e.activeAction=0,e.getPlayerStatus=function(){return"HP: "+o.hp+"<br /> Mp: "+o.mp},e.playerStatus=new Label(e.getPlayerStatus()),e.playerStatus.color="#fff",e.playerStatus.x=200,e.playerStatus.y=120,e.hitStrength=function(t){return Math.round((Math.random()+.5)*t)},e.won=function(){e.over=!0,o.exp+=o.currentEnemy.exp,o.gp+=o.currentEnemy.gp,o.currentEnemy.hp=o.currentEnemy.maxHp,o.statusLabel.text="You won!<br />You gained "+o.currentEnemy.exp+" exp<br />and "+o.currentEnemy.gp+" gold pieces!",o.statusLabel.height=45,o.statusLabel.backgroundColor="#000",o.exp>o.levelStats[o.level].expMax&&(o.level+=1,o.statusLabel.text=o.statusLabel.text+"<br />And you gained a level!<br /> You are now at level "+o.level+"!",o.statusLabel.height=75)},e.lost=function(){e.over=!0,o.hp=o.levelStats[o.level].maxHp,o.mp=o.levelStats[o.level].maxMp,o.gp=Math.round(o.gp/2),o.statusLabel.text="You Lost!",o.statusLabel.height=12,o.statusLabel.backgroundColor="#000"},e.playerAttack=function(){var t=o.currentEnemy,i=e.hitStrength(o.attack());t.hp=t.hp-i,e.menu.text="You did "+i+" damage!",t.hp<=0&&e.won()},e.enemyAttack=function(){var t=o.currentEnemy,i=e.hitStrength(t.attack);o.hp=o.hp-i,e.menu.text="You took "+i+" damage!",o.hp<=0&&e.lost()},e.actions=[{name:"Fight",action:function(){e.wait=!0,e.playerAttack(),setTimeout(function(){e.over||e.enemyAttack(),e.over?setTimeout(function(){e.menu.text="",t.popScene()},1e3):setTimeout(function(){e.menu.text=e.listActions(),e.wait=!1},1e3)},1e3)}},{name:"Magic",action:function(){e.menu.text="You don't know any magic yet!",e.wait=!0,e.activeAction=0,setTimeout(function(){e.menu.text=e.listActions(),e.wait=!1},1e3)}},{name:"run",action:function(){t.pause(),o.statusLabel.text="You ran away!",o.statusLabel.height=12,e.menu.text="",t.popScene()}}],e.listActions=function(){e.optionText=[];for(var t=0;t<e.actions.length;t++)t===e.activeAction?e.optionText[t]=">"+e.actions[t].name:e.optionText[t]=e.actions[t].name;return e.optionText.join("<br />")},e.addCombatants=function(){var i=new Surface(t.spriteSheetWidth,t.spriteSheetHeight);i.draw(t.assets["sprites.png"]),e.player=new Sprite(t.spriteWidth,t.spriteHeight),e.player.image=i,e.player.frame=7,e.player.x=150,e.player.y=120,e.player.scaleX=2,e.player.scaleY=2,e.enemy=new Sprite(t.spriteWidth,t.spriteHeight),e.enemy.image=i,e.enemy.x=150,e.enemy.y=70,e.enemy.scaleX=2,e.enemy.scaleY=2,e.addChild(e.enemy)},e.addCombatants(),v.on("enter",function(){e.over=!1,e.wait=!0,e.menu.text="",e.enemy.frame=o.currentEnemy.sprite,setTimeout(function(){e.menu.text=e.listActions(),e.wait=!1},500)}),v.on("enterframe",function(){e.wait||(t.input.a?e.actions[e.activeAction].action():t.input.down?(e.activeAction=(e.activeAction+1)%e.actions.length,e.menu.text=e.listActions()):t.input.up&&(e.activeAction=(e.activeAction-1+e.actions.length)%e.actions.length,e.menu.text=e.listActions()),e.playerStatus.text=e.getPlayerStatus())}),v.on("exit",function(){setTimeout(function(){e.menu.text="",e.activeAction=0,e.playerStatus.text=e.getPlayerStatus(),t.resume()},1e3)}),e.addChild(e.playerStatus),e.addChild(e.menu),e.addChild(e.player),v.addChild(e)};o.displayStatus=function(){o.statusLabel.backgroundColor="#000",o.statusLabel.text="|-- "+o.name+" --|<br> ++ 职业: "+o.characterClass+"<br> ++ HP: "+o.hp+"/"+o.levelStats[o.level].maxHp+"<br> ++ MP: "+o.mp+"/"+o.levelStats[o.level].maxMp+"<br> ++ 经验值: "+o.exp+"<br> ++ 等级: "+o.level+"<br> ++ 金钱: "+o.gp,o.statusLabel.height=170,o.showInventory(0)},o.clearStatus=function(){o.statusLabel.text="",o.statusLabel.height=0,o.hideInventory()},o.move=function(){if(this.frame=this.spriteOffset+2*this.direction+this.walk,this.isMoving)this.moveBy(this.xMovement,this.yMovement),t.frame%2||(this.walk++,this.walk%=2),(this.xMovement&&this.x%16===0||this.yMovement&&this.y%16===0)&&(this.isMoving=!1,this.walk=1);else if(this.xMovement=0,this.yMovement=0,t.input.up?(this.direction=1,this.yMovement=-4,o.clearStatus()):t.input.right?(this.direction=2,this.xMovement=4,o.clearStatus()):t.input.left?(this.direction=3,this.xMovement=-4,o.clearStatus()):t.input.down&&(this.direction=0,this.yMovement=4,o.clearStatus()),this.xMovement||this.yMovement){var i=this.x+(this.xMovement?this.xMovement/Math.abs(this.xMovement)*16:0),n=this.y+(this.yMovement?this.yMovement/Math.abs(this.yMovement)*16:0);0<=i&&i<e.width&&0<=n&&n<e.height&&!e.hitTest(i,n)&&(this.isMoving=!0,this.move())}},o.square=function(){return{x:Math.floor(this.x/t.spriteWidth),y:Math.floor(this.y/t.spriteHeight)}},o.facingSquare=function(){var t,i=o.square();return 0===o.direction?t={x:i.x,y:i.y+1}:1===o.direction?t={x:i.x,y:i.y-1}:2===o.direction?t={x:i.x+1,y:i.y}:3===o.direction&&(t={x:i.x-1,y:i.y}),t.x<0||t.x>=e.width/16||t.y<0||t.y>=e.height/16?null:t},o.facing=function(){var t=o.facingSquare();return t?r[t.y][t.x]:null},o.visibleItems=[],o.itemSurface=new Surface(t.itemSpriteSheetWidth,t.spriteSheetHeight),o.inventory=[],o.hideInventory=function(){for(var t=0;t<o.visibleItems.length;t++)o.visibleItems[t].remove();o.visibleItems=[]},o.showInventory=function(e){if(0===o.visibleItems.length){o.itemSurface.draw(t.assets["items.png"]);for(var i=0;i<o.inventory.length;i++){var n=new Sprite(t.spriteWidth,t.spriteHeight);n.y=130+e,n.x=30+70*i,n.frame=o.inventory[i],n.scaleX=2,n.scaleY=2,n.image=o.itemSurface,o.visibleItems.push(n),t.currentScene.addChild(n)}}};var u={say:function(t){o.statusLabel.height=80,o.statusLabel.backgroundColor="#000",o.statusLabel.text=t}},d={action:function(){u.say("Hello World")}},f=new Scene,_={action:function(){t.pushScene(f)}},v=new Scene,m={maxHp:20,hp:15,sprite:15,attack:3,exp:3,gp:100,action:function(){o.currentEnemy=this,t.pushScene(v)}},g=[,,d,,_,,,,,,,,,,,m];t.focusViewport=function(){var i=Math.min((t.width-16)/2-o.x,0),n=Math.min((t.height-16)/2-o.y,0);i=Math.max(t.width,i+e.width)-e.width,n=Math.max(t.height,n+e.height)-e.height,t.rootScene.firstChild.x=i,t.rootScene.firstChild.y=n},t.onload=function(){t.storable=["exp","level","gp","inventory"],t.saveToLocalStorage=function(){for(var e=0;e<t.storable.length;e++)"inventory"===t.storable[e]?window.localStorage.setItem(t.storable[e],JSON.stringify(o[t.storable[e]])):window.localStorage.setItem(t.storable[e],o[t.storable[e]])},setInterval(t.saveToLocalStorage,5e3),n(),h(),a(),c(),l(),o.on("enterframe",function(){if(o.move(),t.input.a){var e=o.facing();e&&g[e]?g[e].action():o.displayStatus()}}),t.rootScene.on("enterframe",function(){t.focusViewport()})},t.start()};t.exports=a},function(t,e){!function(t,e){"function"!=typeof Object.defineProperty&&(Object.defineProperty=function(t,e,i){return"value"in i&&(t[e]=i.value),"get"in i&&t.__defineGetter__(e,i.get),"set"in i&&t.__defineSetter__(e,i.set),t}),"function"!=typeof Object.defineProperties&&(Object.defineProperties=function(t,e){for(var i in e)e.hasOwnProperty(i)&&Object.defineProperty(t,i,e[i]);return t}),"function"!=typeof Object.create&&(Object.create=function(t,e){function i(){}i.prototype=t;var n=new i;return null!=e&&Object.defineProperties(n,e),n}),"function"!=typeof Object.getPrototypeOf&&(Object.getPrototypeOf=function(t){return t.__proto__}),"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(e){var i=this,n=Array.prototype.slice.call(arguments,1),s=function(){},r=function(){var r=n.concat(Array.prototype.slice.call(arguments));return i.apply(this instanceof s?this:e||t,r)};return s.prototype=i.prototype,r.prototype=new s,r}),t.getTime=function(){var e;return t.performance&&t.performance.now?(e=Date.now(),function(){return e+t.performance.now()}):t.performance&&t.performance.webkitNow?(e=Date.now(),function(){return e+t.performance.webkitNow()}):Date.now}(),t.requestAnimationFrame=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(){var e=t.getTime(),i=1e3/60;return function(n){var s=setTimeout(function(){e=t.getTime(),n(e)},Math.max(0,e+i-t.getTime()));return s}}();var i=function(e){if(null!=e&&(e instanceof Array||(e=Array.prototype.slice.call(arguments)),e=e.filter(function(t){return[t].join()})),function n(i,s){var r,a,o=[];for(var h in i)i.hasOwnProperty(h)&&("function"==typeof i[h]?t[h]=i[h]:"object"==typeof i[h]&&null!==i[h]&&Object.getPrototypeOf(i[h])===Object.prototype&&(null==e?o.push(h):(r=e.indexOf(s+h),-1!==r&&(o.push(h),e.splice(r,1)))));for(r=0,a=o.length;a>r;r++)n(i[o[r]],s+o[r]+".")}(i,""),i.Class.getInheritanceTree(t.Game).length<=i.Class.getInheritanceTree(t.Core).length&&(t.Game=t.Core),null!=e&&e.length)throw Error("Cannot load module: "+e.join(", "))};t.enchant=i,t.addEventListener("message",function(t){try{var e=JSON.parse(t.data);if("event"===e.type)i.Core.instance.dispatchEvent(new i.Event(e.value));else if("debug"===e.type)switch(e.value){case"start":i.Core.instance.start();break;case"pause":i.Core.instance.pause();break;case"resume":i.Core.instance.resume();break;case"tick":i.Core.instance._tick()}}catch(n){}},!1),i.Class=function(t,e){return i.Class.create(t,e)},i.Class.create=function(t,n){if(null==t&&n)throw Error("superclass is undefined (enchant.Class.create)");if(null==t)throw Error("definition is undefined (enchant.Class.create)");if(0===arguments.length)return i.Class.create(Object,n);if(1===arguments.length&&"function"!=typeof arguments[0])return i.Class.create(Object,arguments[0]);for(var s in n)n.hasOwnProperty(s)&&("object"==typeof n[s]&&null!==n[s]&&Object.getPrototypeOf(n[s])===Object.prototype?"enumerable"in n[s]||(n[s].enumerable=!0):n[s]={value:n[s],enumerable:!0,writable:!0});var r=function(){return this instanceof r?(r.prototype.initialize.apply(this,arguments),e):new r};r.prototype=Object.create(t.prototype,n),r.prototype.constructor=r,null==r.prototype.initialize&&(r.prototype.initialize=function(){t.apply(this,arguments)});for(var a=this.getInheritanceTree(t),o=0,h=a.length;h>o;o++)if("function"==typeof a[o]._inherited){a[o]._inherited(r);break}return r},i.Class.getInheritanceTree=function(t){for(var e=[],i=t,n=i.prototype;i!==Object;)e.push(i),n=Object.getPrototypeOf(n),i=n.constructor;return e},i.ENV={VERSION:"0.8.3",BROWSER:function(t){return/Eagle/.test(t)?"eagle":/Opera/.test(t)?"opera":/MSIE|Trident/.test(t)?"ie":/Chrome/.test(t)?"chrome":/(?:Macintosh|Windows).*AppleWebKit/.test(t)?"safari":/(?:iPhone|iPad|iPod).*AppleWebKit/.test(t)?"mobilesafari":/Firefox/.test(t)?"firefox":/Android/.test(t)?"android":""}(navigator.userAgent),VENDOR_PREFIX:function(){var t=navigator.userAgent;return-1!==t.indexOf("Opera")?"O":/MSIE|Trident/.test(t)?"ms":-1!==t.indexOf("WebKit")?"webkit":"Gecko"===navigator.product?"Moz":""}(),TOUCH_ENABLED:function(){var t=document.createElement("div");return t.setAttribute("ontouchstart","return"),"function"==typeof t.ontouchstart}(),RETINA_DISPLAY:function(){if(-1!==navigator.userAgent.indexOf("iPhone")&&2===t.devicePixelRatio){var e=document.querySelector('meta[name="viewport"]');return null==e&&(e=document.createElement("meta"),document.head.appendChild(e)),e.setAttribute("content","width=640"),!0}return!1}(),USE_FLASH_SOUND:function(){var t=navigator.userAgent,e=navigator.vendor||"";return 0===location.href.indexOf("http")&&-1===t.indexOf("Mobile")&&-1!==e.indexOf("Apple")}(),USE_DEFAULT_EVENT_TAGS:["input","textarea","select","area"],CANVAS_DRAWING_METHODS:["putImageData","drawImage","drawFocusRing","fill","stroke","clearRect","fillRect","strokeRect","fillText","strokeText"],KEY_BIND_TABLE:{37:"left",38:"up",39:"right",40:"down"},PREVENT_DEFAULT_KEY_CODES:[37,38,39,40],SOUND_ENABLED_ON_MOBILE_SAFARI:!0,USE_TOUCH_TO_START_SCENE:!0,USE_WEBAUDIO:function(){return"file:"!==location.protocol}(),USE_ANIMATION:!0,COLOR_DETECTION_LEVEL:2},i.Event=i.Class.create({initialize:function(t){this.type=t,this.target=null,this.x=0,this.y=0,this.localX=0,this.localY=0},_initPosition:function(t,e){var n=i.Core.instance;this.x=this.localX=(t-n._pageX)/n.scale,this.y=this.localY=(e-n._pageY)/n.scale}}),i.Event.LOAD="load",i.Event.ERROR="error",i.Event.CORE_RESIZE="coreresize",i.Event.PROGRESS="progress",i.Event.ENTER_FRAME="enterframe",i.Event.EXIT_FRAME="exitframe",i.Event.ENTER="enter",i.Event.EXIT="exit",i.Event.CHILD_ADDED="childadded",i.Event.ADDED="added",i.Event.ADDED_TO_SCENE="addedtoscene",i.Event.CHILD_REMOVED="childremoved",i.Event.REMOVED="removed",i.Event.REMOVED_FROM_SCENE="removedfromscene",i.Event.TOUCH_START="touchstart",i.Event.TOUCH_MOVE="touchmove",i.Event.TOUCH_END="touchend",i.Event.RENDER="render",i.Event.INPUT_START="inputstart",i.Event.INPUT_CHANGE="inputchange",i.Event.INPUT_END="inputend",i.Event.INPUT_STATE_CHANGED="inputstatechanged",i.Event.LEFT_BUTTON_DOWN="leftbuttondown",i.Event.LEFT_BUTTON_UP="leftbuttonup",i.Event.RIGHT_BUTTON_DOWN="rightbuttondown",i.Event.RIGHT_BUTTON_UP="rightbuttonup",i.Event.UP_BUTTON_DOWN="upbuttondown",i.Event.UP_BUTTON_UP="upbuttonup",i.Event.DOWN_BUTTON_DOWN="downbuttondown",i.Event.DOWN_BUTTON_UP="downbuttonup",i.Event.A_BUTTON_DOWN="abuttondown",i.Event.A_BUTTON_UP="abuttonup",i.Event.B_BUTTON_DOWN="bbuttondown",i.Event.B_BUTTON_UP="bbuttonup",i.Event.ADDED_TO_TIMELINE="addedtotimeline",i.Event.REMOVED_FROM_TIMELINE="removedfromtimeline",i.Event.ACTION_START="actionstart",i.Event.ACTION_END="actionend",i.Event.ACTION_TICK="actiontick",i.Event.ACTION_ADDED="actionadded",i.Event.ACTION_REMOVED="actionremoved",i.Event.ANIMATION_END="animationend",i.EventTarget=i.Class.create({initialize:function(){this._listeners={}},addEventListener:function(t,e){var i=this._listeners[t];null==i?this._listeners[t]=[e]:-1===i.indexOf(e)&&i.unshift(e)},on:function(){this.addEventListener.apply(this,arguments)},removeEventListener:function(t,e){var i=this._listeners[t];if(null!=i){var n=i.indexOf(e);-1!==n&&i.splice(n,1)}},clearEventListener:function(t){null!=t?delete this._listeners[t]:this._listeners={}},dispatchEvent:function(t){t.target=this,t.localX=t.x-this._offsetX,t.localY=t.y-this._offsetY,null!=this["on"+t.type]&&this["on"+t.type](t);var e=this._listeners[t.type];if(null!=e){e=e.slice();for(var i=0,n=e.length;n>i;i++)e[i].call(this,t)}}}),function(){var e;i.Core=i.Class.create(i.EventTarget,{initialize:function(n,s){if(null===t.document.body)throw Error("document.body is null. Please excute 'new Core()' in window.onload.");i.EventTarget.call(this);var r=!0;e&&(r=!1,e.stop()),e=i.Core.instance=this,this._calledTime=0,this._mousedownID=0,this._surfaceID=0,this._soundID=0,this._scenes=[],n=n||320,s=s||320;var a,o,h,c=document.getElementById("enchant-stage");if(c){var l=t.getComputedStyle(c);for(o=parseInt(l.width,10),h=parseInt(l.height,10),a=o&&h?Math.min(o/n,h/s):1;c.firstChild;)c.removeChild(c.firstChild);c.style.position="relative";var u=c.getBoundingClientRect();this._pageX=Math.round(t.scrollX||t.pageXOffset+u.left),this._pageY=Math.round(t.scrollY||t.pageYOffset+u.top)}else c=document.createElement("div"),c.id="enchant-stage",c.style.position="absolute",document.body.firstChild?document.body.insertBefore(c,document.body.firstChild):document.body.appendChild(c),a=Math.min(t.innerWidth/n,t.innerHeight/s),this._pageX=c.getBoundingClientRect().left,this._pageY=c.getBoundingClientRect().top;c.style.fontSize="12px",c.style.webkitTextSizeAdjust="none",c.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)",this._element=c,this.addEventListener("coreresize",this._oncoreresize),this._width=n,this._height=s,this.scale=a,this.fps=30,this.frame=0,this.ready=!1,this.running=!1,this.assets={},this._assets=[],function f(t){t.assets&&i.Core.instance.preload(t.assets);for(var e in t)t.hasOwnProperty(e)&&"object"==typeof t[e]&&null!==t[e]&&Object.getPrototypeOf(t[e])===Object.prototype&&f(t[e])}(i),this.currentScene=null,this.rootScene=new i.Scene,this.pushScene(this.rootScene),this.loadingScene=new i.LoadingScene,this._activated=!1,this._offsetX=0,this._offsetY=0,this.input={},this.keyboardInputManager=new i.KeyboardInputManager(t.document,this.input),this.keyboardInputManager.addBroadcastTarget(this),this._keybind=this.keyboardInputManager._binds,i.ENV.KEY_BIND_TABLE||(i.ENV.KEY_BIND_TABLE={});for(var d in i.ENV.KEY_BIND_TABLE)this.keybind(d,i.ENV.KEY_BIND_TABLE[d]);r&&(c=i.Core.instance._element,document.addEventListener("keydown",function(t){e.dispatchEvent(new i.Event("keydown")),-1!==i.ENV.PREVENT_DEFAULT_KEY_CODES.indexOf(t.keyCode)&&(t.preventDefault(),t.stopPropagation())},!0),i.ENV.TOUCH_ENABLED&&(c.addEventListener("touchstart",function(t){var n=t.target.tagName.toLowerCase();-1===i.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(n)&&(t.preventDefault(),e.running||t.stopPropagation())},!0),c.addEventListener("touchmove",function(t){var n=t.target.tagName.toLowerCase();-1===i.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(n)&&(t.preventDefault(),e.running||t.stopPropagation())},!0),c.addEventListener("touchend",function(t){var n=t.target.tagName.toLowerCase();-1===i.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(n)&&(t.preventDefault(),e.running||t.stopPropagation())},!0)),c.addEventListener("mousedown",function(t){var n=t.target.tagName.toLowerCase();-1===i.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(n)&&(t.preventDefault(),e._mousedownID++,e.running||t.stopPropagation())},!0),c.addEventListener("mousemove",function(t){var n=t.target.tagName.toLowerCase();-1===i.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(n)&&(t.preventDefault(),e.running||t.stopPropagation())},!0),c.addEventListener("mouseup",function(t){var n=t.target.tagName.toLowerCase();-1===i.ENV.USE_DEFAULT_EVENT_TAGS.indexOf(n)&&(t.preventDefault(),e.running||t.stopPropagation())},!0),e._touchEventTarget={},i.ENV.TOUCH_ENABLED&&(c.addEventListener("touchstart",function(t){for(var e,n,s=i.Core.instance,r=new i.Event(i.Event.TOUCH_START),a=t.changedTouches,o=0,h=a.length;h>o;o++)e=a[o],r._initPosition(e.pageX,e.pageY),n=s.currentScene._determineEventTarget(r),s._touchEventTarget[e.identifier]=n,n.dispatchEvent(r)},!1),c.addEventListener("touchmove",function(t){for(var e,n,s=i.Core.instance,r=new i.Event(i.Event.TOUCH_MOVE),a=t.changedTouches,o=0,h=a.length;h>o;o++)e=a[o],n=s._touchEventTarget[e.identifier],n&&(r._initPosition(e.pageX,e.pageY),n.dispatchEvent(r))},!1),c.addEventListener("touchend",function(t){for(var e,n,s=i.Core.instance,r=new i.Event(i.Event.TOUCH_END),a=t.changedTouches,o=0,h=a.length;h>o;o++)e=a[o],n=s._touchEventTarget[e.identifier],n&&(r._initPosition(e.pageX,e.pageY),n.dispatchEvent(r),delete s._touchEventTarget[e.identifier])},!1)),c.addEventListener("mousedown",function(t){var e=i.Core.instance,n=new i.Event(i.Event.TOUCH_START);n._initPosition(t.pageX,t.pageY);var s=e.currentScene._determineEventTarget(n);e._touchEventTarget[e._mousedownID]=s,s.dispatchEvent(n)},!1),c.addEventListener("mousemove",function(t){var e=i.Core.instance,n=new i.Event(i.Event.TOUCH_MOVE);n._initPosition(t.pageX,t.pageY);var s=e._touchEventTarget[e._mousedownID];s&&s.dispatchEvent(n)},!1),c.addEventListener("mouseup",function(t){var e=i.Core.instance,n=new i.Event(i.Event.TOUCH_END);n._initPosition(t.pageX,t.pageY);var s=e._touchEventTarget[e._mousedownID];s&&s.dispatchEvent(n),delete e._touchEventTarget[e._mousedownID]},!1))},width:{get:function(){return this._width},set:function(t){this._width=t,this._dispatchCoreResizeEvent()}},height:{get:function(){return this._height},set:function(t){this._height=t,this._dispatchCoreResizeEvent()}},scale:{get:function(){return this._scale},set:function(t){this._scale=t,this._dispatchCoreResizeEvent()}},_dispatchCoreResizeEvent:function(){var t=new i.Event("coreresize");t.width=this._width,t.height=this._height,t.scale=this._scale,this.dispatchEvent(t)},_oncoreresize:function(t){this._element.style.width=Math.floor(this._width*this._scale)+"px",this._element.style.height=Math.floor(this._height*this._scale)+"px";for(var e,i=0,n=this._scenes.length;n>i;i++)e=this._scenes[i],e.dispatchEvent(t)},preload:function(t){var e;if(!(t instanceof Array))if("object"==typeof t){e=[];for(var i in t)t.hasOwnProperty(i)&&e.push([t[i],i]);t=e}else t=Array.prototype.slice.call(arguments);return Array.prototype.push.apply(this._assets,t),this},load:function(t,n,s,r){var a;if("string"==typeof arguments[1])a=n,s=s||function(){},r=r||function(){};else{a=t;var o=s;s=arguments[1]||function(){},r=o||function(){}}var h=i.Core.findExt(t);return i.Deferred.next(function(){var n=new i.Deferred,o=function(t){n.call(t),s.call(this,t)},c=function(t){n.fail(t),r.call(this,t)};if(i.Core._loadFuncs[h])i.Core.instance.assets[a]=i.Core._loadFuncs[h](t,h,o,c);else{var l=new XMLHttpRequest;l.open("GET",t,!0),l.onreadystatechange=function(){if(4===l.readyState){if(200!==l.status&&0!==l.status){var n=new i.Event("error");n.message=l.status+": Cannot load an asset: "+t,c.call(i.Core.instance,n)}var s=l.getResponseHeader("Content-Type")||"";s.match(/^image/)?e.assets[a]=i.Surface.load(t,o,c):s.match(/^audio/)?e.assets[a]=i.Sound.load(t,s,o,c):(e.assets[a]=l.responseText,o.call(i.Core.instance,new i.Event("load")))}},l.send(null)}return n})},start:function(n){var s=function(){this.frame=0,this.removeEventListener("load",s)};if(this.addEventListener("load",s),this.currentTime=t.getTime(),this.running=!0,this.ready=!0,!this._activated&&(this._activated=!0,"mobilesafari"===i.ENV.BROWSER&&i.ENV.USE_WEBAUDIO&&i.ENV.USE_TOUCH_TO_START_SCENE)){var r=new i.Deferred,a=this._createTouchToStartScene();return a.addEventListener(i.Event.TOUCH_START,function h(){this.removeEventListener(i.Event.TOUCH_START,h);var t=new i.WebAudioSound;t.buffer=i.WebAudioSound.audioContext.createBuffer(1,1,48e3),t.play(),e.removeScene(a),e.start(r)},!1),e.pushScene(a),r}this._requestNextFrame(0);var o=this._requestPreload().next(function(){i.Core.instance.loadingScene.dispatchEvent(new i.Event(i.Event.LOAD))});return n&&o.next(function(t){n.call(t)}).error(function(t){n.fail(t)}),o},_requestPreload:function(){var t={},n=0,s=0,r=function(){var t=new i.Event("progress");t.loaded=++n,t.total=s,e.loadingScene.dispatchEvent(t)};return this._assets.reverse().forEach(function(e){var i,n;e instanceof Array?(i=e[0],n=e[1]):i=n=e,t[n]||(t[n]=this.load(i,n,r),s++)},this),this.pushScene(this.loadingScene),i.Deferred.parallel(t)},_createTouchToStartScene:function(){var t=new i.Label("Touch to Start"),n=Math.round(e.width/10),s=new i.Scene;return t.color="#fff",t.font=n-1+"px bold Helvetica,Arial,sans-serif",t.textAlign="center",t.width=e.width,t.height=t._boundHeight,t.y=(e.height-t.height)/2,s.backgroundColor="#000",s.addChild(t),s},debug:function(){return this._debug=!0,this.start()},actualFps:{get:function(){return this._actualFps||this.fps}},_requestNextFrame:function(e){this.ready&&(this.fps>=60||16>=e?(this._calledTime=t.getTime(),t.requestAnimationFrame(this._callTick)):setTimeout(function(){var e=i.Core.instance;e._calledTime=t.getTime(),t.requestAnimationFrame(e._callTick)},Math.max(0,e)))},_callTick:function(t){i.Core.instance._tick(t)},_tick:function(){var e=new i.Event("enterframe"),n=t.getTime(),s=e.elapsed=n-this.currentTime;this.currentTime=n,this._actualFps=s>0?1e3/s:0;for(var r=this.currentScene.childNodes.slice(),a=Array.prototype.push;r.length;){var o=r.pop();o.age++,o.dispatchEvent(e),o.childNodes&&a.apply(r,o.childNodes)}this.currentScene.age++,this.currentScene.dispatchEvent(e),this.dispatchEvent(e),this.dispatchEvent(new i.Event("exitframe")),this.frame++,n=t.getTime(),this._requestNextFrame(1e3/this.fps-(n-this._calledTime))},getTime:function(){return t.getTime()},stop:function(){this.ready=!1,this.running=!1},pause:function(){this.ready=!1},resume:function(){this.ready||(this.currentTime=t.getTime(),this.ready=!0,this.running=!0,this._requestNextFrame(0))},pushScene:function(t){return this._element.appendChild(t._element),this.currentScene&&this.currentScene.dispatchEvent(new i.Event("exit")),this.currentScene=t,this.currentScene.dispatchEvent(new i.Event("enter")),this._scenes.push(t)},popScene:function(){return this.currentScene===this.rootScene?this.currentScene:(this._element.removeChild(this.currentScene._element),this.currentScene.dispatchEvent(new i.Event("exit")),this.currentScene=this._scenes[this._scenes.length-2],this.currentScene.dispatchEvent(new i.Event("enter")),this._scenes.pop())},replaceScene:function(t){return this.popScene(),this.pushScene(t)},removeScene:function(t){if(this.currentScene===t)return this.popScene();var e=this._scenes.indexOf(t);return-1!==e?(this._scenes.splice(e,1),this._element.removeChild(t._element),t):null},_buttonListener:function(t){this.currentScene.dispatchEvent(t)},keybind:function(t,e){return this.keyboardInputManager.keybind(t,e),this.addEventListener(e+"buttondown",this._buttonListener),this.addEventListener(e+"buttonup",this._buttonListener),this},keyunbind:function(t){var e=this._keybind[t];return this.keyboardInputManager.keyunbind(t),this.removeEventListener(e+"buttondown",this._buttonListener),this.removeEventListener(e+"buttonup",this._buttonListener),this},changeButtonState:function(t,e){this.keyboardInputManager.changeState(t,e)},getElapsedTime:function(){return this.frame/this.fps}}),i.Core._loadFuncs={},i.Core._loadFuncs.jpg=i.Core._loadFuncs.jpeg=i.Core._loadFuncs.gif=i.Core._loadFuncs.png=i.Core._loadFuncs.bmp=function(t,e,n,s){return i.Surface.load(t,n,s)},i.Core._loadFuncs.mp3=i.Core._loadFuncs.aac=i.Core._loadFuncs.m4a=i.Core._loadFuncs.wav=i.Core._loadFuncs.ogg=function(t,e,n,s){return i.Sound.load(t,"audio/"+e,n,s)},i.Core.findExt=function(t){var e=t.match(/\.\w+$/);return e&&e.length>0?e[0].slice(1).toLowerCase():0===t.indexOf("data:")?t.split(/[\/;]/)[1].toLowerCase():null},i.Core.instance=null}(),i.Game=i.Core,i.InputManager=i.Class.create(i.EventTarget,{initialize:function(t,e){i.EventTarget.call(this),this.broadcastTarget=[],this.valueStore=t,this.source=e||this,this._binds={},this._stateHandler=function(t){var e=t.source.identifier,i=this._binds[e];this.changeState(i,t.data)}.bind(this)},bind:function(t,e){t.addEventListener(i.Event.INPUT_STATE_CHANGED,this._stateHandler),this._binds[t.identifier]=e},unbind:function(t){t.removeEventListener(i.Event.INPUT_STATE_CHANGED,this._stateHandler),delete this._binds[t.identifier]},addBroadcastTarget:function(t){var e=this.broadcastTarget.indexOf(t);-1===e&&this.broadcastTarget.push(t)},removeBroadcastTarget:function(t){var e=this.broadcastTarget.indexOf(t);-1!==e&&this.broadcastTarget.splice(e,1)},broadcastEvent:function(t){for(var e=this.broadcastTarget,i=0,n=e.length;n>i;i++)e[i].dispatchEvent(t)},changeState:function(){}}),i.InputSource=i.Class.create(i.EventTarget,{initialize:function(t){i.EventTarget.call(this),this.identifier=t},notifyStateChange:function(t){var e=new i.Event(i.Event.INPUT_STATE_CHANGED);e.data=t,e.source=this,this.dispatchEvent(e)}}),i.BinaryInputManager=i.Class.create(i.InputManager,{initialize:function(t,e,n,s){i.InputManager.call(this,t,s),this.activeInputsNum=0,this.activeEventNameSuffix=e,this.inactiveEventNameSuffix=n},bind:function(t,e){i.InputManager.prototype.bind.call(this,t,e),this.valueStore[e]=!1},unbind:function(t){var e=this._binds[t.identifier];i.InputManager.prototype.unbind.call(this,t),
delete this.valueStore[e]},changeState:function(t,e){e?this._down(t):this._up(t)},_down:function(t){var e;this.valueStore[t]||(this.valueStore[t]=!0,e=new i.Event(this.activeInputsNum++?"inputchange":"inputstart"),e.source=this.source,this.broadcastEvent(e));var n=new i.Event(t+this.activeEventNameSuffix);n.source=this.source,this.broadcastEvent(n)},_up:function(t){var e;this.valueStore[t]&&(this.valueStore[t]=!1,e=new i.Event(--this.activeInputsNum?"inputchange":"inputend"),e.source=this.source,this.broadcastEvent(e));var n=new i.Event(t+this.inactiveEventNameSuffix);n.source=this.source,this.broadcastEvent(n)}}),i.BinaryInputSource=i.Class.create(i.InputSource,{initialize:function(t){i.InputSource.call(this,t)}}),i.KeyboardInputManager=i.Class.create(i.BinaryInputManager,{initialize:function(t,e){i.BinaryInputManager.call(this,e,"buttondown","buttonup"),this._attachDOMEvent(t,"keydown",!0),this._attachDOMEvent(t,"keyup",!1)},keybind:function(t,e){this.bind(i.KeyboardInputSource.getByKeyCode(""+t),e)},keyunbind:function(t){this.unbind(i.KeyboardInputSource.getByKeyCode(""+t))},_attachDOMEvent:function(t,e,n){t.addEventListener(e,function(t){var e=i.Core.instance;if(e&&e.running){var s=t.keyCode,r=i.KeyboardInputSource._instances[s];r&&r.notifyStateChange(n)}},!0)}}),i.KeyboardInputSource=i.Class.create(i.BinaryInputSource,{initialize:function(t){i.BinaryInputSource.call(this,t)}}),i.KeyboardInputSource._instances={},i.KeyboardInputSource.getByKeyCode=function(t){return this._instances[t]||(this._instances[t]=new i.KeyboardInputSource(t)),this._instances[t]},i.Node=i.Class.create(i.EventTarget,{initialize:function(){i.EventTarget.call(this),this._dirty=!1,this._matrix=[1,0,0,1,0,0],this._x=0,this._y=0,this._offsetX=0,this._offsetY=0,this.age=0,this.parentNode=null,this.scene=null,this.addEventListener("touchstart",function(t){this.parentNode&&this.parentNode.dispatchEvent(t)}),this.addEventListener("touchmove",function(t){this.parentNode&&this.parentNode.dispatchEvent(t)}),this.addEventListener("touchend",function(t){this.parentNode&&this.parentNode.dispatchEvent(t)}),i.ENV.USE_ANIMATION&&(this.tl=new i.Timeline(this))},moveTo:function(t,e){this.x=t,this.y=e},moveBy:function(t,e){this.x+=t,this.y+=e},x:{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._dirty=!0)}},y:{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._dirty=!0)}},_updateCoordinate:function(){var t=this,e=[t],n=t.parentNode;for(this.scene;n&&t._dirty;)e.unshift(n),t=t.parentNode,n=t.parentNode;var s,r,a,o=i.Matrix.instance,h=o.stack,c=[];h.push(e[0]._matrix);for(var l=1,u=e.length;u>l;l++){t=e[l],s=[],o.makeTransformMatrix(t,c),o.multiply(h[h.length-1],c,s),t._matrix=s,h.push(s),r="number"==typeof t._originX?t._originX:t._width/2||0,a="number"==typeof t._originY?t._originY:t._height/2||0;var d=[r,a];o.multiplyVec(s,d,d),t._offsetX=d[0]-r,t._offsetY=d[1]-a,t._dirty=!1}o.reset()},remove:function(){if(this.parentNode&&this.parentNode.removeChild(this),this.childNodes)for(var t=this.childNodes.slice(),e=t.length-1;e>=0;e--)t[e].remove();this.clearEventListener()}});var n=function(t,e){for(var i,n=[],s=0,r=t.collection.length;r>s;s++)i=t.collection[s],e._intersectOne(i)&&n.push(i);return n},s=function(t,e){for(var i,n,s=[],r=0,a=t.collection.length;a>r;r++){i=t.collection[r];for(var o=0,h=e.collection.length;h>o;o++)n=e.collection[o],i._intersectOne(n)&&s.push([i,n])}return s},r=function(t,e){for(var i,n=[],s=0,r=t.collection.length;r>s;s++)i=t.collection[s],e._intersectStrictOne(i)&&n.push(i);return n},a=function(t,e){for(var i,n,s=[],r=0,a=t.collection.length;a>r;r++){i=t.collection[r];for(var o=0,h=e.collection.length;h>o;o++)n=e.collection[o],i._intersectStrictOne(n)&&s.push([i,n])}return s},o=function(t){return t instanceof i.Entity?n(this,t):!("function"!=typeof t||!t.collection)&&s(this,t)},h=function(t){return t instanceof i.Entity?r(this,t):!("function"!=typeof t||!t.collection)&&a(this,t)},c=i.Node.prototype.clearEventListener;i.Entity=i.Class.create(i.Node,{initialize:function(){var t=i.Core.instance;i.Node.call(this),this._rotation=0,this._scaleX=1,this._scaleY=1,this._touchEnabled=!0,this._clipping=!1,this._originX=null,this._originY=null,this._width=0,this._height=0,this._backgroundColor=null,this._debugColor="#0000ff",this._opacity=1,this._visible=!0,this._buttonMode=null,this._style={},this.__styleStatus={},this._isContainedInCollection=!1,this.compositeOperation=null,this.buttonMode=null,this.buttonPressed=!1,this.addEventListener("touchstart",function(){this.buttonMode&&(this.buttonPressed=!0,this.dispatchEvent(new i.Event(this.buttonMode+"buttondown")),t.changeButtonState(this.buttonMode,!0))}),this.addEventListener("touchend",function(){this.buttonMode&&(this.buttonPressed=!1,this.dispatchEvent(new i.Event(this.buttonMode+"buttonup")),t.changeButtonState(this.buttonMode,!1))}),this.enableCollection()},width:{get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this._dirty=!0)}},height:{get:function(){return this._height},set:function(t){this._height!==t&&(this._height=t,this._dirty=!0)}},backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t}},debugColor:{get:function(){return this._debugColor},set:function(t){this._debugColor=t}},opacity:{get:function(){return this._opacity},set:function(t){this._opacity=parseFloat(t)}},visible:{get:function(){return this._visible},set:function(t){this._visible=t}},touchEnabled:{get:function(){return this._touchEnabled},set:function(t){this._touchEnabled=t,this._style.pointerEvents=t?"all":"none"}},intersect:function(t){return t instanceof i.Entity?this._intersectOne(t):!("function"!=typeof t||!t.collection)&&n(t,this)},_intersectOne:function(t){return this._dirty&&this._updateCoordinate(),t._dirty&&t._updateCoordinate(),this._offsetX<t._offsetX+t.width&&t._offsetX<this._offsetX+this.width&&this._offsetY<t._offsetY+t.height&&t._offsetY<this._offsetY+this.height},intersectStrict:function(t){return t instanceof i.Entity?this._intersectStrictOne(t):!("function"!=typeof t||!t.collection)&&r(t,this)},_intersectStrictOne:function(t){this._dirty&&this._updateCoordinate(),t._dirty&&t._updateCoordinate();var e,i,n,s,r,a,o,h,c,l,u,d,f,_,v,m,g,p,E,y,w,x,C,S=this.getOrientedBoundingRect(),T=t.getOrientedBoundingRect(),b=S.leftTop,N=S.rightTop,M=S.leftBottom,O=S.rightBottom,A=T.leftTop,L=T.rightTop,I=T.leftBottom,D=T.rightBottom,R=b[0],k=b[1],P=N[0],U=N[1],B=M[0],X=M[1],Y=O[0],F=O[1],H=A[0],V=A[1],W=L[0],q=L[1],z=I[0],G=I[1],j=D[0],K=D[1],Q=[P-R,U-k],J=[Y-P,F-U],Z=[B-Y,X-F],$=[R-B,k-X],tt=[W-H,q-V],et=[j-W,K-q],it=[z-j,G-K],nt=[H-z,V-G],st=R+P+B+Y>>2,rt=k+U+X+F>>2,at=H+W+z+j>>2,ot=V+q+G+K>>2;if(Q[0]*(ot-k)-Q[1]*(at-R)>0&&J[0]*(ot-U)-J[1]*(at-P)>0&&Z[0]*(ot-F)-Z[1]*(at-Y)>0&&$[0]*(ot-X)-$[1]*(at-B)>0)return!0;if(tt[0]*(rt-V)-tt[1]*(st-H)>0&&et[0]*(rt-q)-et[1]*(st-W)>0&&it[0]*(rt-K)-it[1]*(st-j)>0&&nt[0]*(rt-G)-nt[1]*(st-z)>0)return!0;for(n=[b,N,O,M],s=[A,L,D,I],r=[Q,J,Z,$],a=[tt,et,it,nt],e=0;4>e;e++)for(o=n[e],u=o[0],d=o[1],c=r[e],v=c[0],m=c[1],i=0;4>i;i++)if(h=s[i],f=h[0],_=h[1],l=a[i],g=l[0],p=l[1],w=v*p-m*g,0!==w&&(E=f-u,y=_-d,x=(E*m-y*v)/w,C=(E*p-y*g)/w,x>0&&1>x&&C>0&&1>C))return!0;return!1},within:function(t,e){this._dirty&&this._updateCoordinate(),t._dirty&&t._updateCoordinate(),null==e&&(e=(this.width+this.height+t.width+t.height)/4);var i;return e*e>(i=this._offsetX-t._offsetX+(this.width-t.width)/2)*i+(i=this._offsetY-t._offsetY+(this.height-t.height)/2)*i},scale:function(t,e){this._scaleX*=t,this._scaleY*=null!=e?e:t,this._dirty=!0},rotate:function(t){this.rotation+=t},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX!==t&&(this._scaleX=t,this._dirty=!0)}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY!==t&&(this._scaleY=t,this._dirty=!0)}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this._dirty=!0)}},originX:{get:function(){return this._originX},set:function(t){this._originX!==t&&(this._originX=t,this._dirty=!0)}},originY:{get:function(){return this._originY},set:function(t){this._originY!==t&&(this._originY=t,this._dirty=!0)}},enableCollection:function(){this.addEventListener("addedtoscene",this._addSelfToCollection),this.addEventListener("removedfromscene",this._removeSelfFromCollection),this.scene&&this._addSelfToCollection()},disableCollection:function(){this.removeEventListener("addedtoscene",this._addSelfToCollection),this.removeEventListener("removedfromscene",this._removeSelfFromCollection),this.scene&&this._removeSelfFromCollection()},clearEventListener:function(){c.apply(this,arguments),this.scene&&this._removeSelfFromCollection()},_addSelfToCollection:function(){if(!this._isContainedInCollection){var t=this.getConstructor();t._collectionTarget.forEach(function(t){t.collection.push(this)},this),this._isContainedInCollection=!0}},_removeSelfFromCollection:function(){if(this._isContainedInCollection){var t=this.getConstructor();t._collectionTarget.forEach(function(t){var e=t.collection.indexOf(this);-1!==e&&t.collection.splice(e,1)},this),this._isContainedInCollection=!1}},getBoundingRect:function(){var t=this.width||0,e=this.height||0,i=this._matrix,n=i[0]*t,s=i[1]*t,r=i[2]*e,a=i[3]*e,o=i[4],h=i[5],c=[o,n+o,r+o,n+r+o].sort(function(t,e){return t-e}),l=[h,s+h,a+h,s+a+h].sort(function(t,e){return t-e});return{left:c[0],top:l[0],width:c[3]-c[0],height:l[3]-l[0]}},getOrientedBoundingRect:function(){var t=this.width||0,e=this.height||0,i=this._matrix,n=i[0]*t,s=i[1]*t,r=i[2]*e,a=i[3]*e,o=i[4],h=i[5];return{leftTop:[o,h],rightTop:[n+o,s+h],leftBottom:[r+o,a+h],rightBottom:[n+r+o,s+a+h]}},getConstructor:function(){return Object.getPrototypeOf(this).constructor}});var l=function(t){if(!t._collective){var e=i.Class.getInheritanceTree(t),n=e.indexOf(i.Entity);t._collectionTarget=-1!==n?e.splice(0,n+1):[],t.intersect=o,t.intersectStrict=h,t.collection=[],t._collective=!0}};l(i.Entity),i.Entity._inherited=function(t){l(t)},i.Sprite=i.Class.create(i.Entity,{initialize:function(t,e){i.Entity.call(this),this.width=t,this.height=e,this._image=null,this._debugColor="#ff0000",this._frameLeft=0,this._frameTop=0,this._frame=0,this._frameSequence=null},image:{get:function(){return this._image},set:function(t){if(t===e)throw Error("Assigned value on Sprite.image is undefined. Please double-check image path, and check if the image you want to use is preload before use.");t!==this._image&&(this._image=t,this._computeFramePosition())}},frame:{get:function(){return this._frame},set:function(t){null==this._frameSequence&&this._frame===t||this._deepCompareToPreviousFrame(t)||(t instanceof Array?this._frameSequence=t:(this._frameSequence=null,this._frame=t,this._computeFramePosition()))}},_frameSequence:{get:function(){return this.__frameSequence},set:function(t){t&&!this.__frameSequence?this.addEventListener(i.Event.ENTER_FRAME,this._rotateFrameSequence):!t&&this.__frameSequence&&this.removeEventListener(i.Event.ENTER_FRAME,this._rotateFrameSequence),t?(this.__frameSequence=t.slice(),this._originalFrameSequence=t.slice(),this._rotateFrameSequence()):(this.__frameSequence=null,this._originalFrameSequence=null)}},_deepCompareToPreviousFrame:function(t){if(t===this._originalFrameSequence)return!0;if(null==t||null==this._originalFrameSequence)return!1;if(!(t instanceof Array))return!1;if(t.length!==this._originalFrameSequence.length)return!1;for(var e=0;t.length>e;++e)if(t[e]!==this._originalFrameSequence[e])return!1;return!0},_computeFramePosition:function(){var t,e=this._image;null!=e&&(t=0|e.width/this._width,this._frameLeft=(0|this._frame%t)*this._width,this._frameTop=(0|this._frame/t)*this._height%e.height)},_rotateFrameSequence:function(){var t=this._frameSequence;if(t&&0!==t.length){var e=t.shift();null===e?(this._frameSequence=null,this.dispatchEvent(new i.Event(i.Event.ANIMATION_END))):(this._frame=e,this._computeFramePosition(),t.push(e))}},width:{get:function(){return this._width},set:function(t){this._width=t,this._computeFramePosition(),this._dirty=!0}},height:{get:function(){return this._height},set:function(t){this._height=t,this._computeFramePosition(),this._dirty=!0}},cvsRender:function(t){var e,n,s,r,a,o,h,c=this._image,l=this._width,u=this._height;c&&0!==l&&0!==u&&(e=c.width,n=c.height,l>e||u>n?(t.fillStyle=i.Surface._getPattern(c),t.fillRect(0,0,l,u)):(s=c._element,r=this._frameLeft,a=Math.min(this._frameTop,n-u),o=Math.max(.01,Math.min(e-r,l)),h=Math.max(.01,Math.min(n-a,u)),t.drawImage(s,r,a,o,h,0,0,l,u)))},domRender:function(){return"ms"===i.ENV.VENDOR_PREFIX?function(){this._image&&(this._image._css?(this._style["background-image"]=this._image._css,this._style["background-position"]=-this._frameLeft+"px "+-this._frameTop+"px"):this._image._element)}:function(){this._image&&(this._image._css?(this._style["background-image"]=this._image._css,this._style["background-position"]=-this._frameLeft+"px "+-this._frameTop+"px"):this._image._element)}}()}),i.Label=i.Class.create(i.Entity,{initialize:function(t){i.Entity.call(this),this.text=t||"",this.width=300,this.font="14px serif",this.textAlign="left",this._debugColor="#ff0000"},width:{get:function(){return this._width},set:function(t){this._width=t,this._dirty=!0,this.updateBoundArea()}},text:{get:function(){return this._text},set:function(t){if(t=""+t,this._text!==t){this._text=t,t=t.replace(/<br ?\/?>/gi,"<br/>"),this._splitText=t.split("<br/>"),this.updateBoundArea();for(var e=0,i=this._splitText.length;i>e;e++){t=this._splitText[e];var n=this.getMetrics(t);this._splitText[e]={},this._splitText[e].text=t,this._splitText[e].height=n.height,this._splitText[e].width=n.width}}}},textAlign:{get:function(){return this._style["text-align"]},set:function(t){this._style["text-align"]=t,this.updateBoundArea()}},font:{get:function(){return this._style.font},set:function(t){this._style.font=t,this.updateBoundArea()}},color:{get:function(){return this._style.color},set:function(t){this._style.color=t}},cvsRender:function(t){var e,i,n,s,r,a,o,h,c,l=0,u=this.width;if(this._splitText){t.textBaseline="top",t.font=this.font,t.fillStyle=this.color||"#000000",i=t.measureText(" ").width,n=u/i;for(var d=0,f=this._splitText.length;f>d;d++){for(s=this._splitText[d],r=s.text,a=0;r.length>a+n||t.measureText(r.slice(a,a+n)).width>u;){for(o="",h=n,c=0;h>0;)u>t.measureText(o).width?(c+=h,o=r.slice(a,a+c)):(c-=h,o=r.slice(a,a+c)),h=0|h/2;t.fillText(o,0,l),l+=s.height-1,a+=c}o=r.slice(a,a+r.length),e="right"===this.textAlign?u-t.measureText(o).width:"center"===this.textAlign?(u-t.measureText(o).width)/2:0,t.fillText(o,e,l),l+=s.height-1}}},domRender:function(t){t.innerHTML!==this._text&&(t.innerHTML=this._text)},detectRender:function(t){t.fillRect(this._boundOffset,0,this._boundWidth,this._boundHeight)},updateBoundArea:function(){var t=this.getMetrics();this._boundWidth=t.width,this._boundHeight=t.height,this._boundOffset="right"===this.textAlign?this.width-this._boundWidth:"center"===this.textAlign?(this.width-this._boundWidth)/2:0},getMetrics:function(t){var e,i={};if(document.body){e=document.createElement("div");for(var n in this._style)"width"!==n&&"height"!==n&&(e.style[n]=this._style[n]);t=t||this._text,e.innerHTML=t.replace(/ /g,"&nbsp;"),e.style.whiteSpace="noWrap",e.style.lineHeight=1,document.body.appendChild(e);var s=getComputedStyle(e);i.height=parseInt(s.height,10)+1,e.style.position="absolute",i.width=parseInt(s.width,10)+1,document.body.removeChild(e)}else i.width=this.width,i.height=this.height;return i}}),i.Map=i.Class.create(i.Entity,{initialize:function(t,e){var n=i.Core.instance;i.Entity.call(this);var s=new i.Surface(n.width,n.height);this._surface=s;var r=s._element;r.style.position="absolute",i.ENV.RETINA_DISPLAY&&2===n.scale?(r.width=2*n.width,r.height=2*n.height,this._style.webkitTransformOrigin="0 0",this._style.webkitTransform="scale(0.5)"):(r.width=n.width,r.height=n.height),this._context=r.getContext("2d"),this._tileWidth=t||0,this._tileHeight=e||0,this._image=null,this._data=[[[]]],this._dirty=!1,this._tight=!1,this.touchEnabled=!1,this.collisionData=null,this._listeners.render=null,this.addEventListener("render",function(){this._dirty&&(this._previousOffsetX=this._previousOffsetY=null)})},loadData:function(t){this._data=Array.prototype.slice.apply(arguments),this._dirty=!0,this._tight=!1;for(var e=0,i=this._data.length;i>e;e++){var n=0;t=this._data[e];for(var s=0,r=t.length;r>s;s++)for(var a=0,o=t[s].length;o>a;a++)t[s][a]>=0&&n++;if(n/(t.length*t[0].length)>.2){this._tight=!0;break}}},checkTile:function(t,e){if(0>t||t>=this.width||0>e||e>=this.height)return!1;var i=this._image.width,n=this._image.height,s=this._tileWidth||i,r=this._tileHeight||n;t=0|t/s,e=0|e/r;var a=this._data[0];return a[e][t]},hitTest:function(t,e){if(0>t||t>=this.width||0>e||e>=this.height)return!1;var i=this._image.width,n=this._image.height,s=this._tileWidth||i,r=this._tileHeight||n;if(t=0|t/s,e=0|e/r,null!=this.collisionData)return this.collisionData[e]&&!!this.collisionData[e][t];for(var a=0,o=this._data.length;o>a;a++){var h,c=this._data[a];if(null!=c[e]&&null!=(h=c[e][t])&&h>=0&&(0|i/s)*(0|n/r)>h)return!0}return!1},image:{get:function(){return this._image},set:function(t){var e=i.Core.instance;if(this._image=t,i.ENV.RETINA_DISPLAY&&2===e.scale){for(var n=new i.Surface(2*t.width,2*t.height),s=this._tileWidth||t.width,r=this._tileHeight||t.height,a=0|t.width/s,o=0|t.height/r,h=0;o>h;h++)for(var c=0;a>c;c++)n.draw(t,c*s,h*r,s,r,2*c*s,2*h*r,2*s,2*r);this._doubledImage=n}this._dirty=!0}},tileWidth:{get:function(){return this._tileWidth},set:function(t){this._tileWidth!==t&&(this._tileWidth=t,this._dirty=!0)}},tileHeight:{get:function(){return this._tileHeight},set:function(t){this._tileHeight!==t&&(this._tileHeight=t,this._dirty=!0)}},width:{get:function(){return this._tileWidth*this._data[0][0].length}},height:{get:function(){return this._tileHeight*this._data[0].length}},redraw:function(t,e,i,n){if(null!=this._image){var s,r,a,o,h;this._doubledImage?(s=this._doubledImage,r=2*this._tileWidth,a=2*this._tileHeight,o=2*-this._offsetX,h=2*-this._offsetY,t*=2,e*=2,i*=2,n*=2):(s=this._image,r=this._tileWidth,a=this._tileHeight,o=-this._offsetX,h=-this._offsetY);var c=0|s.width/r,l=0|s.height/a,u=Math.max(0|(t+o)/r,0),d=Math.max(0|(e+h)/a,0),f=Math.ceil((t+o+i)/r),_=Math.ceil((e+h+n)/a),v=s._element,m=this._context;m.canvas,m.clearRect(t,e,i,n);for(var g=0,p=this._data.length;p>g;g++){var E=this._data[g],y=Math.min(f,E[0].length),w=Math.min(_,E.length);for(e=d;w>e;e++)for(t=u;y>t;t++){var x=E[e][t];if(x>=0&&c*l>x){var C=x%c*r,S=(0|x/c)*a;m.drawImage(v,C,S,r,a,t*r-o,e*a-h,r,a)}}}}},updateBuffer:function(){if(this._visible===e||this._visible){var t=i.Core.instance;if(this._dirty||null==this._previousOffsetX)this.redraw(0,0,t.width,t.height);else if(this._offsetX!==this._previousOffsetX||this._offsetY!==this._previousOffsetY)if(this._tight){var n=-this._offsetX,s=-this._offsetY,r=-this._previousOffsetX,a=-this._previousOffsetY,o=n-r+t.width,h=r-n+t.width,c=s-a+t.height,l=a-s+t.height;if(o>this._tileWidth&&h>this._tileWidth&&c>this._tileHeight&&l>this._tileHeight){var u,d,f,_,v,m;h>o?(u=0,f=r-n,v=o):(u=n-r,f=0,v=h),l>c?(d=0,_=a-s,m=c):(d=s-a,_=0,m=l),null==t._buffer&&(t._buffer=document.createElement("canvas"),t._buffer.width=this._context.canvas.width,t._buffer.height=this._context.canvas.height);var g=t._buffer.getContext("2d");this._doubledImage?(g.clearRect(0,0,2*v,2*m),g.drawImage(this._context.canvas,2*u,2*d,2*v,2*m,0,0,2*v,2*m),g=this._context,g.clearRect(2*f,2*_,2*v,2*m),g.drawImage(t._buffer,0,0,2*v,2*m,2*f,2*_,2*v,2*m)):(g.clearRect(0,0,v,m),g.drawImage(this._context.canvas,u,d,v,m,0,0,v,m),g=this._context,g.clearRect(f,_,v,m),g.drawImage(t._buffer,0,0,v,m,f,_,v,m)),0===f?this.redraw(v,0,t.width-v,t.height):this.redraw(0,0,t.width-v,t.height),0===_?this.redraw(0,m,t.width,t.height-m):this.redraw(0,0,t.width,t.height-m)}else this.redraw(0,0,t.width,t.height)}else this.redraw(0,0,t.width,t.height);this._previousOffsetX=this._offsetX,this._previousOffsetY=this._offsetY}},cvsRender:function(t){if(0!==this.width&&0!==this.height){var e=i.Core.instance;this.updateBuffer(),t.save(),t.setTransform(1,0,0,1,0,0);var n=this._context.canvas;t.drawImage(n,0,0,e.width,e.height),t.restore()}},domRender:function(){this._image&&(this.updateBuffer(),this._style["background-image"]=this._surface._css,this._style[i.ENV.VENDOR_PREFIX+"Transform"]="matrix(1, 0, 0, 1, 0, 0)")}}),i.Group=i.Class.create(i.Node,{initialize:function(){this.childNodes=[],i.Node.call(this),this._rotation=0,this._scaleX=1,this._scaleY=1,this._originX=null,this._originY=null,this.__dirty=!1,[i.Event.ADDED_TO_SCENE,i.Event.REMOVED_FROM_SCENE].forEach(function(t){this.addEventListener(t,function(t){this.childNodes.forEach(function(e){e.scene=this.scene,e.dispatchEvent(t)},this)})},this)},addChild:function(t){t.parentNode&&t.parentNode.removeChild(t),this.childNodes.push(t),t.parentNode=this;var e=new i.Event("childadded");if(e.node=t,e.next=null,this.dispatchEvent(e),t.dispatchEvent(new i.Event("added")),this.scene){t.scene=this.scene;var n=new i.Event("addedtoscene");t.dispatchEvent(n)}},insertBefore:function(t,e){t.parentNode&&t.parentNode.removeChild(t);var n=this.childNodes.indexOf(e);if(-1!==n){this.childNodes.splice(n,0,t),t.parentNode=this;var s=new i.Event("childadded");if(s.node=t,s.next=e,this.dispatchEvent(s),t.dispatchEvent(new i.Event("added")),this.scene){t.scene=this.scene;var r=new i.Event("addedtoscene");t.dispatchEvent(r)}}else this.addChild(t)},removeChild:function(t){var e;if(-1!==(e=this.childNodes.indexOf(t))){this.childNodes.splice(e,1),t.parentNode=null;var n=new i.Event("childremoved");if(n.node=t,this.dispatchEvent(n),t.dispatchEvent(new i.Event("removed")),this.scene){t.scene=null;var s=new i.Event("removedfromscene");t.dispatchEvent(s)}}},firstChild:{get:function(){return this.childNodes[0]}},lastChild:{get:function(){return this.childNodes[this.childNodes.length-1]}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this._dirty=!0)}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX!==t&&(this._scaleX=t,this._dirty=!0)}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY!==t&&(this._scaleY=t,this._dirty=!0)}},originX:{get:function(){return this._originX},set:function(t){this._originX!==t&&(this._originX=t,this._dirty=!0)}},originY:{get:function(){return this._originY},set:function(t){this._originY!==t&&(this._originY=t,this._dirty=!0)}},_dirty:{get:function(){return this.__dirty},set:function(t){if(t=!!t,this.__dirty=t,t)for(var e=0,i=this.childNodes.length;i>e;e++)this.childNodes[e]._dirty=!0}}}),i.Matrix=i.Class.create({initialize:function(){this.reset()},reset:function(){this.stack=[],this.stack.push([1,0,0,1,0,0])},makeTransformMatrix:function(t,e){var i=t._x,n=t._y,s=t.width||0,r=t.height||0,a=t._rotation||0,o="number"==typeof t._scaleX?t._scaleX:1,h="number"==typeof t._scaleY?t._scaleY:1,c=a*Math.PI/180,l=Math.cos(c),u=Math.sin(c),d="number"==typeof t._originX?t._originX:s/2,f="number"==typeof t._originY?t._originY:r/2,_=o*l,v=o*u,m=h*u,g=h*l;e[0]=_,e[1]=v,e[2]=-m,e[3]=g,e[4]=-_*d+m*f+i+d,e[5]=-v*d-g*f+n+f},multiply:function(t,e,i){var n=t[0],s=t[2],r=t[4],a=t[1],o=t[3],h=t[5],c=e[0],l=e[2],u=e[4],d=e[1],f=e[3],_=e[5];i[0]=n*c+s*d,i[1]=a*c+o*d,i[2]=n*l+s*f,i[3]=a*l+o*f,i[4]=n*u+s*_+r,i[5]=a*u+o*_+h},multiplyVec:function(t,e,i){var n=e[0],s=e[1],r=t[0],a=t[2],o=t[4],h=t[1],c=t[3],l=t[5];i[0]=r*n+a*s+o,i[1]=h*n+c*s+l}}),i.Matrix.instance=new i.Matrix,i.DetectColorManager=i.Class.create({initialize:function(t,e){this.reference=[],this.colorResolution=t||16,this.max=e||1,this.capacity=Math.pow(this.colorResolution,3);for(var i=1,n=this.capacity;n>i;i++)this.reference[i]=null},attachDetectColor:function(t){var e=this.reference.indexOf(null);return-1===e&&(e=1),this.reference[e]=t,this._getColor(e)},detachDetectColor:function(t){var e=this.reference.indexOf(t);-1!==e&&(this.reference[e]=null)},_getColor:function(t){var e=this.colorResolution,i=e/this.max;return[parseInt(t/e/e%e,10)/i,parseInt(t/e%e,10)/i,parseInt(t%e,10)/i,1]},_decodeDetectColor:function(t,e){e=e||0;var i=this.colorResolution;return~~(t[e]*i*i*i/256)+~~(t[e+1]*i*i/256)+~~(t[e+2]*i/256)},getSpriteByColor:function(t){return this.reference[this._decodeDetectColor(t)]},getSpriteByColors:function(t){var e,i,n,s,r=0,a={};for(e=0,i=t.length;i>e;e+=4)n=this._decodeDetectColor(t,e),a[n]=(a[n]||0)+1;for(n in a)a[n]>r&&(r=a[n],s=n);return this.reference[s]}}),i.DomManager=i.Class.create({initialize:function(t,e){var n=i.Core.instance;this.layer=null,this.targetNode=t,"string"==typeof e?this.element=document.createElement(e):e instanceof HTMLElement&&(this.element=e),this.style=this.element.style,this.style.position="absolute",this.style[i.ENV.VENDOR_PREFIX+"TransformOrigin"]="0px 0px",n._debug&&(this.style.border="1px solid blue",this.style.margin="-1px");var s=this;this._setDomTarget=function(){s.layer._touchEventTarget=s.targetNode},this._attachEvent()},getDomElement:function(){return this.element},getDomElementAsNext:function(){return this.element},getNextManager:function(t){var e=this.targetNode.parentNode.childNodes.indexOf(t.targetNode);return e!==this.targetNode.parentNode.childNodes.length-1?this.targetNode.parentNode.childNodes[e+1]._domManager:null},addManager:function(t,e){var i;e&&(i=e.getDomElementAsNext());var n=t.getDomElement();n instanceof Array?n.forEach(function(t){i?this.element.insertBefore(t,i):this.element.appendChild(t)},this):i?this.element.insertBefore(n,i):this.element.appendChild(n),this.setLayer(this.layer)},removeManager:function(t){t instanceof i.DomlessManager?t._domRef.forEach(function(t){this.element.removeChild(t)},this):this.element.removeChild(t.element),this.setLayer(this.layer)},setLayer:function(t){this.layer=t;var e,i=this.targetNode;if(i.childNodes)for(var n=0,s=i.childNodes.length;s>n;n++)e=i.childNodes[n]._domManager,e&&e.setLayer(t)},render:function(t){var e=this.targetNode,n=i.Matrix.instance,s=n.stack,r=[];n.makeTransformMatrix(e,r),n.multiply(s[s.length-1],r,r),n.multiply(t,r,t),e._matrix=t;var a="number"==typeof e._originX?e._originX:e.width/2||0,o="number"==typeof e._originY?e._originY:e.height/2||0,h=[a,o];n.multiplyVec(r,h,h),e._offsetX=h[0]-a,e._offsetY=h[1]-o,!e.parentNode||e.parentNode instanceof i.Group||(e._offsetX+=e.parentNode._offsetX,e._offsetY+=e.parentNode._offsetY),e._dirty&&(this.style[i.ENV.VENDOR_PREFIX+"Transform"]="matrix("+r[0].toFixed(10)+","+r[1].toFixed(10)+","+r[2].toFixed(10)+","+r[3].toFixed(10)+","+r[4].toFixed(10)+","+r[5].toFixed(10)+")"),this.domRender()},domRender:function(){var t=this.targetNode;t._style||(t._style={}),t.__styleStatus||(t.__styleStatus={}),null!==t.width&&(t._style.width=t.width+"px"),null!==t.height&&(t._style.height=t.height+"px"),t._style.opacity=t._opacity,t._style["background-color"]=t._backgroundColor,t._visible!==e&&(t._style.display=t._visible?"block":"none"),"function"==typeof t.domRender&&t.domRender(this.element);var i;for(var n in t._style)i=t._style[n],t.__styleStatus[n]!==i&&null!=i&&(this.style.setProperty(n,""+i),t.__styleStatus[n]=i)},_attachEvent:function(){i.ENV.TOUCH_ENABLED&&this.element.addEventListener("touchstart",this._setDomTarget,!0),this.element.addEventListener("mousedown",this._setDomTarget,!0)},_detachEvent:function(){i.ENV.TOUCH_ENABLED&&this.element.removeEventListener("touchstart",this._setDomTarget,!0),this.element.removeEventListener("mousedown",this._setDomTarget,!0)},remove:function(){this._detachEvent(),this.element=this.style=this.targetNode=null}}),i.DomlessManager=i.Class.create({initialize:function(t){this._domRef=[],this.targetNode=t},_register:function(t,e){var i=this._domRef.indexOf(e);t instanceof Array?-1===i?Array.prototype.push.apply(this._domRef,t):Array.prototype.splice.apply(this._domRef,[i,0].concat(t)):-1===i?this._domRef.push(t):this._domRef.splice(i,0,t)},getNextManager:function(t){var e=this.targetNode.parentNode.childNodes.indexOf(t.targetNode);return e!==this.targetNode.parentNode.childNodes.length-1?this.targetNode.parentNode.childNodes[e+1]._domManager:null},getDomElement:function(){var t=[];return this.targetNode.childNodes.forEach(function(e){t=t.concat(e._domManager.getDomElement())}),t},getDomElementAsNext:function(){if(this._domRef.length)return this._domRef[0];var t=this.getNextManager(this);return t?t.element:null},addManager:function(t,e){var n=this.targetNode.parentNode;n&&(null===e&&(e=this.getNextManager(this)),n instanceof i.Scene?n._layers.Dom._domManager.addManager(t,e):n._domManager.addManager(t,e));var s=e?e.getDomElementAsNext():null;this._register(t.getDomElement(),s),this.setLayer(this.layer)},removeManager:function(t){var e,i=this._domRef.indexOf(t.element);-1!==i&&(e=this._domRef[i],e.parentNode.removeChild(e),this._domRef.splice(i,1)),this.setLayer(this.layer)},setLayer:function(t){this.layer=t;var e,i=this.targetNode;if(i.childNodes)for(var n=0,s=i.childNodes.length;s>n;n++)e=i.childNodes[n]._domManager,e&&e.setLayer(t)},render:function(t){var e=i.Matrix.instance,n=e.stack,s=this.targetNode,r=[];e.makeTransformMatrix(s,r),e.multiply(n[n.length-1],r,r),e.multiply(t,r,t),s._matrix=t;var a="number"==typeof s._originX?s._originX:s.width/2||0,o="number"==typeof s._originY?s._originY:s.height/2||0,h=[a,o];e.multiplyVec(r,h,h),s._offsetX=h[0]-a,s._offsetY=h[1]-o,n.push(r)},remove:function(){this._domRef=[],this.targetNode=null}}),i.DomLayer=i.Class.create(i.Group,{initialize:function(){var t=i.Core.instance;i.Group.call(this),this._touchEventTarget=null,this._element=document.createElement("div"),this._element.style.position="absolute",this._domManager=new i.DomManager(this,this._element),this._domManager.layer=this,this.width=t.width,this.height=t.height;var e=[i.Event.TOUCH_START,i.Event.TOUCH_MOVE,i.Event.TOUCH_END];e.forEach(function(t){this.addEventListener(t,function(t){this._scene&&this._scene.dispatchEvent(t)})},this);var n=function(t){var e=t.node,r=t.next,a=t.target,o=r?r._domManager:null;i.DomLayer._attachDomManager(e,n,s),a._domManager.addManager(e._domManager,o);var h=new i.Event(i.Event.RENDER);e._dirty=!0,a._domManager.layer._rendering(e,h)},s=function(t){var e=t.node,r=t.target;r._domManager.removeManager(e._domManager),i.DomLayer._detachDomManager(e,n,s)};this.addEventListener("childremoved",s),this.addEventListener("childadded",n)},width:{get:function(){return this._width},set:function(t){this._width=t,this._element.style.width=t+"px"}},height:{get:function(){return this._height},set:function(t){this._height=t,this._element.style.height=t+"px"}},addChild:function(t){this.childNodes.push(t),t.parentNode=this;var e=new i.Event("childadded");if(e.node=t,e.next=null,this.dispatchEvent(e),t.dispatchEvent(new i.Event("added")),this.scene){t.scene=this.scene;var n=new i.Event("addedtoscene");t.dispatchEvent(n)}},insertBefore:function(t,e){var n=this.childNodes.indexOf(e);if(-1!==n){this.childNodes.splice(n,0,t),t.parentNode=this;var s=new i.Event("childadded");if(s.node=t,s.next=e,this.dispatchEvent(s),t.dispatchEvent(new i.Event("added")),this.scene){t.scene=this.scene;var r=new i.Event("addedtoscene");t.dispatchEvent(r)}}else this.addChild(t)},_startRendering:function(){this.addEventListener("exitframe",this._onexitframe),this._onexitframe()},_stopRendering:function(){this.removeEventListener("exitframe",this._onexitframe),this._onexitframe()},_onexitframe:function(){this._rendering(this,new i.Event(i.Event.RENDER))},_rendering:function(t,e,n){var s;if(n||(n=[1,0,0,1,0,0]),t.dispatchEvent(e),t._domManager.render(n),t.childNodes)for(var r=0,a=t.childNodes.length;a>r;r++)s=t.childNodes[r],this._rendering(s,e,n.slice());t._domManager instanceof i.DomlessManager&&i.Matrix.instance.stack.pop(),t._dirty=!1},_determineEventTarget:function(){var t=this._touchEventTarget;return this._touchEventTarget=null,
t===this?null:t}}),i.DomLayer._attachDomManager=function(t,e,n){var s;if(t._domManager||(t.addEventListener("childadded",e),t.addEventListener("childremoved",n),t._domManager=t instanceof i.Group?new i.DomlessManager(t):t._element?new i.DomManager(t,t._element):new i.DomManager(t,"div")),t.childNodes)for(var r=0,a=t.childNodes.length;a>r;r++)s=t.childNodes[r],i.DomLayer._attachDomManager(s,e,n),t._domManager.addManager(s._domManager,null)},i.DomLayer._detachDomManager=function(t,e,n){var s;if(t.removeEventListener("childadded",e),t.removeEventListener("childremoved",n),t.childNodes)for(var r=0,a=t.childNodes.length;a>r;r++)s=t.childNodes[r],t._domManager.removeManager(s._domManager,null),i.DomLayer._detachDomManager(s,e,n);t._domManager.remove(),delete t._domManager},i.CanvasLayer=i.Class.create(i.Group,{initialize:function(){var t=i.Core.instance;i.Group.call(this),this._cvsCache={matrix:[1,0,0,1,0,0],detectColor:"#000000"},this._cvsCache.layer=this,this._element=document.createElement("canvas"),this._element.style.position="absolute",this._element.style.left=this._element.style.top="0px",this._detect=document.createElement("canvas"),this._detect.style.position="absolute",this._lastDetected=0,this.context=this._element.getContext("2d"),this._dctx=this._detect.getContext("2d"),this._setImageSmoothingEnable(),this._colorManager=new i.DetectColorManager(16,256),this.width=t.width,this.height=t.height;var e=[i.Event.TOUCH_START,i.Event.TOUCH_MOVE,i.Event.TOUCH_END];e.forEach(function(t){this.addEventListener(t,function(t){this._scene&&this._scene.dispatchEvent(t)})},this);var n=function(t){var e,r=t.node,a=t.target;e=a instanceof i.CanvasLayer?a._scene._layers.Canvas:a.scene._layers.Canvas,i.CanvasLayer._attachCache(r,e,n,s);var o=new i.Event(i.Event.RENDER);a._dirty&&a._updateCoordinate(),r._dirty=!0,i.Matrix.instance.stack.push(a._matrix),i.CanvasRenderer.instance.render(e.context,r,o),i.Matrix.instance.stack.pop(a._matrix)},s=function(t){var e,r=t.node,a=t.target;e=a instanceof i.CanvasLayer?a._scene._layers.Canvas:a.scene._layers.Canvas,i.CanvasLayer._detachCache(r,e,n,s)};this.addEventListener("childremoved",s),this.addEventListener("childadded",n)},width:{get:function(){return this._width},set:function(t){this._width=t,this._element.width=this._detect.width=t,this._setImageSmoothingEnable()}},height:{get:function(){return this._height},set:function(t){this._height=t,this._element.height=this._detect.height=t,this._setImageSmoothingEnable()}},addChild:function(t){this.childNodes.push(t),t.parentNode=this;var e=new i.Event("childadded");e.node=t,e.next=null,this.dispatchEvent(e),t.dispatchEvent(new i.Event("added"))},insertBefore:function(t,e){var n=this.childNodes.indexOf(e);if(-1!==n){this.childNodes.splice(n,0,t),t.parentNode=this;var s=new i.Event("childadded");s.node=t,s.next=e,this.dispatchEvent(s),t.dispatchEvent(new i.Event("added"))}else this.addChild(t)},_startRendering:function(){this.addEventListener("exitframe",this._onexitframe),this._onexitframe()},_stopRendering:function(){this.removeEventListener("exitframe",this._onexitframe),this._onexitframe()},_onexitframe:function(){var t=i.Core.instance,e=this.context;e.clearRect(0,0,t.width,t.height);var n=new i.Event(i.Event.RENDER);i.CanvasRenderer.instance.render(e,this,n)},_determineEventTarget:function(t){return this._getEntityByPosition(t.x,t.y)},_getEntityByPosition:function(t,e){var n=i.Core.instance,s=this._dctx;this._lastDetected<n.frame&&(s.clearRect(0,0,this.width,this.height),i.CanvasRenderer.instance.detectRender(s,this),this._lastDetected=n.frame);var r=i.ENV.COLOR_DETECTION_LEVEL-1,a=s.getImageData(t-r,e-r,1+2*r,1+2*r).data;return this._colorManager.getSpriteByColors(a)},_setImageSmoothingEnable:function(){this._dctx.imageSmoothingEnabled=this._dctx.msImageSmoothingEnabled=this._dctx.mozImageSmoothingEnabled=this._dctx.webkitImageSmoothingEnabled=!1}}),i.CanvasLayer._attachCache=function(t,e,n,s){var r;if(t._cvsCache||(t._cvsCache={},t._cvsCache.matrix=[1,0,0,1,0,0],t._cvsCache.detectColor="rgba("+e._colorManager.attachDetectColor(t)+")",t.addEventListener("childadded",n),t.addEventListener("childremoved",s)),t.childNodes)for(var a=0,o=t.childNodes.length;o>a;a++)r=t.childNodes[a],i.CanvasLayer._attachCache(r,e,n,s)},i.CanvasLayer._detachCache=function(t,e,n,s){var r;if(t._cvsCache&&(e._colorManager.detachDetectColor(t),t.removeEventListener("childadded",n),t.removeEventListener("childremoved",s),delete t._cvsCache),t.childNodes)for(var a=0,o=t.childNodes.length;o>a;a++)r=t.childNodes[a],i.CanvasLayer._detachCache(r,e,n,s)},i.CanvasRenderer=i.Class.create({render:function(t,n,s){var r,a,o;if(t.save(),n.dispatchEvent(s),this.transform(t,n),(n._visible===e||n._visible)&&(r=n.width,a=n.height,n.compositeOperation&&(t.globalCompositeOperation=n.compositeOperation),t.globalAlpha="number"==typeof n._opacity?n._opacity:1,n._backgroundColor&&(t.fillStyle=n._backgroundColor,t.fillRect(0,0,r,a)),n.cvsRender&&n.cvsRender(t),i.Core.instance._debug&&n._debugColor&&(t.strokeStyle=n._debugColor,t.strokeRect(0,0,r,a)),n._clipping&&(t.beginPath(),t.rect(0,0,r,a),t.clip()),n.childNodes))for(var h=0,c=n.childNodes.length;c>h;h++)o=n.childNodes[h],this.render(t,o,s);t.restore(),i.Matrix.instance.stack.pop()},detectRender:function(t,n){var s,r,a;if(n._visible===e||n._visible){if(s=n.width,r=n.height,t.save(),this.transform(t,n),t.fillStyle=n._cvsCache.detectColor,n._touchEnabled&&(n.detectRender?n.detectRender(t):t.fillRect(0,0,s,r)),n._clipping&&(t.beginPath(),t.rect(0,0,s,r),t.clip()),n.childNodes)for(var o=0,h=n.childNodes.length;h>o;o++)a=n.childNodes[o],this.detectRender(t,a);t.restore(),i.Matrix.instance.stack.pop()}},transform:function(t,e){var n,s,r,a,o=i.Matrix.instance,h=o.stack;e._dirty?(o.makeTransformMatrix(e,e._cvsCache.matrix),n=[],o.multiply(h[h.length-1],e._cvsCache.matrix,n),e._matrix=n,s="number"==typeof e._originX?e._originX:e._width/2||0,r="number"==typeof e._originY?e._originY:e._height/2||0,a=[s,r],o.multiplyVec(n,a,a),e._offsetX=a[0]-s,e._offsetY=a[1]-r,e._dirty=!1):n=e._matrix,h.push(n),t.setTransform.apply(t,n)}}),i.CanvasRenderer.instance=new i.CanvasRenderer,i.Scene=i.Class.create(i.Group,{initialize:function(){var t=i.Core.instance;i.Group.call(this),this.scene=this,this._backgroundColor=null,this._element=document.createElement("div"),this._element.style.position="absolute",this._element.style.overflow="hidden",this._element.style[i.ENV.VENDOR_PREFIX+"TransformOrigin"]="0 0",this._layers={},this._layerPriority=[],this.addEventListener(i.Event.CHILD_ADDED,this._onchildadded),this.addEventListener(i.Event.CHILD_REMOVED,this._onchildremoved),this.addEventListener(i.Event.ENTER,this._onenter),this.addEventListener(i.Event.EXIT,this._onexit);var e=this;this._dispatchExitframe=function(){var t;for(var n in e._layers)t=e._layers[n],t.dispatchEvent(new i.Event(i.Event.EXIT_FRAME))},this.addEventListener(i.Event.CORE_RESIZE,this._oncoreresize),this._oncoreresize(t)},x:{get:function(){return this._x},set:function(t){this._x=t;for(var e in this._layers)this._layers[e].x=t}},y:{get:function(){return this._y},set:function(t){this._y=t;for(var e in this._layers)this._layers[e].y=t}},width:{get:function(){return this._width},set:function(t){this._width=t;for(var e in this._layers)this._layers[e].width=t}},height:{get:function(){return this._height},set:function(t){this._height=t;for(var e in this._layers)this._layers[e].height=t}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t;for(var e in this._layers)this._layers[e].rotation=t}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX=t;for(var e in this._layers)this._layers[e].scaleX=t}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY=t;for(var e in this._layers)this._layers[e].scaleY=t}},backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=this._element.style.backgroundColor=t}},remove:function(){for(this.clearEventListener();this.childNodes.length>0;)this.childNodes[0].remove();return i.Core.instance.removeScene(this)},_oncoreresize:function(t){this._element.style.width=t.width+"px",this.width=t.width,this._element.style.height=t.height+"px",this.height=t.height,this._element.style[i.ENV.VENDOR_PREFIX+"Transform"]="scale("+t.scale+")";for(var e in this._layers)this._layers[e].dispatchEvent(t)},addLayer:function(t,e){var n=i.Core.instance;if(!this._layers[t]){var s=new i[t+"Layer"];n.currentScene===this&&s._startRendering(),this._layers[t]=s;var r=s._element;if("number"==typeof e){var a=this._element.childNodes[e];a?this._element.insertBefore(r,a):this._element.appendChild(r),this._layerPriority.splice(e,0,t)}else this._element.appendChild(r),this._layerPriority.push(t);s._scene=this}},_determineEventTarget:function(t){for(var e,i,n=this._layerPriority.length-1;n>=0&&(e=this._layers[this._layerPriority[n]],!(i=e._determineEventTarget(t)));n--);return i||(i=this),i},_onchildadded:function(t){var e,i,n=t.node,s=t.next;n._element?(e="Dom",i=1):(e="Canvas",i=0),this._layers[e]||this.addLayer(e,i),n._layer=this._layers[e],this._layers[e].insertBefore(n,s),n.parentNode=this},_onchildremoved:function(t){var e=t.node;e._layer.removeChild(e),e._layer=null},_onenter:function(){for(var t in this._layers)this._layers[t]._startRendering();i.Core.instance.addEventListener("exitframe",this._dispatchExitframe)},_onexit:function(){for(var t in this._layers)this._layers[t]._stopRendering();i.Core.instance.removeEventListener("exitframe",this._dispatchExitframe)}}),i.LoadingScene=i.Class.create(i.Scene,{initialize:function(){i.Scene.call(this),this.backgroundColor="#000";var t=0|.4*this.width,e=0|.05*this.width,n=0|.03*t,s=new i.Sprite(t,e);s.disableCollection(),s.x=(this.width-t)/2,s.y=(this.height-e)/2;var r=new i.Surface(t,e);r.context.fillStyle="#fff",r.context.fillRect(0,0,t,e),r.context.fillStyle="#000",r.context.fillRect(n,n,t-2*n,e-2*n),s.image=r;var a=0,o=0;this.addEventListener("progress",function(t){a=1*(t.loaded/t.total)}),s.addEventListener("enterframe",function(){o*=.9,o+=.1*a,r.context.fillStyle="#fff",r.context.fillRect(n,0,(t-2*n)*o,e)}),this.addChild(s),this.addEventListener("load",function(t){var e=i.Core.instance;e.removeScene(e.loadingScene),e.dispatchEvent(t)})}}),i.CanvasScene=i.Class.create(i.Scene,{initialize:function(){i.Scene.call(this),this.addLayer("Canvas")},_determineEventTarget:function(t){var e=this._layers.Canvas._determineEventTarget(t);return e||(e=this),e},_onchildadded:function(t){var e=t.node,i=t.next;e._layer=this._layers.Canvas,this._layers.Canvas.insertBefore(e,i)},_onenter:function(){this._layers.Canvas._startRendering(),i.Core.instance.addEventListener("exitframe",this._dispatchExitframe)},_onexit:function(){this._layers.Canvas._stopRendering(),i.Core.instance.removeEventListener("exitframe",this._dispatchExitframe)}}),i.DOMScene=i.Class.create(i.Scene,{initialize:function(){i.Scene.call(this),this.addLayer("Dom")},_determineEventTarget:function(t){var e=this._layers.Dom._determineEventTarget(t);return e||(e=this),e},_onchildadded:function(t){var e=t.node,i=t.next;e._layer=this._layers.Dom,this._layers.Dom.insertBefore(e,i)},_onenter:function(){this._layers.Dom._startRendering(),i.Core.instance.addEventListener("exitframe",this._dispatchExitframe)},_onexit:function(){this._layers.Dom._stopRendering(),i.Core.instance.removeEventListener("exitframe",this._dispatchExitframe)}}),i.Surface=i.Class.create(i.EventTarget,{initialize:function(t,e){i.EventTarget.call(this);var n=i.Core.instance;this.width=Math.ceil(t),this.height=Math.ceil(e),this.context=null;var s="enchant-surface"+n._surfaceID++;document.getCSSCanvasContext?(this.context=document.getCSSCanvasContext("2d",s,t,e),this._element=this.context.canvas,this._css="-webkit-canvas("+s+")",this.context):document.mozSetImageElement?(this._element=document.createElement("canvas"),this._element.width=t,this._element.height=e,this._css="-moz-element(#"+s+")",this.context=this._element.getContext("2d"),document.mozSetImageElement(s,this._element)):(this._element=document.createElement("canvas"),this._element.width=t,this._element.height=e,this._element.style.position="absolute",this.context=this._element.getContext("2d"),i.ENV.CANVAS_DRAWING_METHODS.forEach(function(t){var e=this.context[t];this.context[t]=function(){e.apply(this,arguments),this._dirty=!0}},this))},getPixel:function(t,e){return this.context.getImageData(t,e,1,1).data},setPixel:function(t,e,i,n,s,r){var a=this.context.createImageData(1,1);a.data[0]=i,a.data[1]=n,a.data[2]=s,a.data[3]=r,this.context.putImageData(a,t,e)},clear:function(){this.context.clearRect(0,0,this.width,this.height)},draw:function(t){if(t=t._element,1===arguments.length)this.context.drawImage(t,0,0);else{var e=arguments;e[0]=t,this.context.drawImage.apply(this.context,e)}},clone:function(){var t=new i.Surface(this.width,this.height);return t.draw(this),t},toDataURL:function(){var t=this._element.src;return t?"data:"===t.slice(0,5)?t:this.clone().toDataURL():this._element.toDataURL()}}),i.Surface.load=function(t,e,n){var s=new Image,r=Object.create(i.Surface.prototype,{context:{value:null},_css:{value:"url("+t+")"},_element:{value:s}});return i.EventTarget.call(r),n=n||function(){},r.addEventListener("load",e),r.addEventListener("error",n),s.onerror=function(){var t=new i.Event(i.Event.ERROR);t.message="Cannot load an asset: "+s.src,i.Core.instance.dispatchEvent(t),r.dispatchEvent(t)},s.onload=function(){r.width=s.width,r.height=s.height,r.dispatchEvent(new i.Event("load"))},s.src=t,r},i.Surface._staticCanvas2DContext=document.createElement("canvas").getContext("2d"),i.Surface._getPattern=function(t,e){return(!t._pattern||e)&&(t._pattern=this._staticCanvas2DContext.createPattern(t._element,"repeat")),t._pattern},t.Deferred?i.Deferred=t.Deferred:(i.Deferred=i.Class.create({initialize:function(){this._succ=this._fail=this._next=this._id=null,this._tail=this},next:function(t){var e=new i.Deferred;return e._succ=t,this._add(e)},error:function(t){var e=new i.Deferred;return e._fail=t,this._add(e)},_add:function(t){return this._tail._next=t,this._tail=t,this},call:function(t){for(var e,n=this;n&&!n._succ;)n=n._next;if(n instanceof i.Deferred){try{e=n._succ(t)}catch(s){return n.fail(s)}e instanceof i.Deferred?i.Deferred._insert(n,e):n._next instanceof i.Deferred&&n._next.call(e)}},fail:function(t){for(var e,n,s=this;s&&!s._fail;)s=s._next;if(!(s instanceof i.Deferred))throw t instanceof Error?t:(n=Error("failed in Deferred"),n.arg=t,n);e=s._fail(t),s.call(e)}}),i.Deferred._insert=function(t,e){t._next instanceof i.Deferred&&(e._tail._next=t._next),t._next=e},i.Deferred.next=function(t){var e=(new i.Deferred).next(t);return e._id=setTimeout(function(){e.call()},0),e},i.Deferred.parallel=function(t){var e=new i.Deferred;e._id=setTimeout(function(){e.call()},0);var n=0,s=t instanceof Array?[]:{},r=new i.Deferred;for(var a in t)t.hasOwnProperty(a)&&(n++,function(t,e){t.next(function(t){n--,s[e]=t,0>=n&&r.call(s)}).error(function(t){r.fail(t)}),"number"==typeof t._id&&clearTimeout(t._id),t._id=setTimeout(function(){t.call()},0)}(t[a],a));return n||(r._id=setTimeout(function(){r.call(s)},0)),e.next(function(){return r})}),i.DOMSound=i.Class.create(i.EventTarget,{initialize:function(){throw i.EventTarget.call(this),this.duration=0,Error("Illegal Constructor")},play:function(){this._element&&this._element.play()},pause:function(){this._element&&this._element.pause()},stop:function(){this.pause(),this.currentTime=0},clone:function(){var t;if(this._element instanceof Audio)t=Object.create(i.DOMSound.prototype,{_element:{value:this._element.cloneNode(!1)},duration:{value:this.duration}});else{if(i.ENV.USE_FLASH_SOUND)return this;t=Object.create(i.DOMSound.prototype)}return i.EventTarget.call(t),t},currentTime:{get:function(){return this._element?this._element.currentTime:0},set:function(t){this._element&&(this._element.currentTime=t)}},volume:{get:function(){return this._element?this._element.volume:1},set:function(t){this._element&&(this._element.volume=t)}}}),i.DOMSound.load=function(e,n,s,r){if(null==n){var a=i.Core.findExt(e);n=a?"audio/"+a:""}n=n.replace("mp3","mpeg").replace("m4a","mp4"),s=s||function(){},r=r||function(){};var o=Object.create(i.DOMSound.prototype);i.EventTarget.call(o),o.addEventListener("load",s),o.addEventListener("error",r);var h=new Audio;if(!i.ENV.SOUND_ENABLED_ON_MOBILE_SAFARI&&"webkit"===i.ENV.VENDOR_PREFIX&&i.ENV.TOUCH_ENABLED)t.setTimeout(function(){o.dispatchEvent(new i.Event("load"))},0);else if(!i.ENV.USE_FLASH_SOUND&&h.canPlayType(n))h.addEventListener("canplaythrough",function u(){o.duration=h.duration,o.dispatchEvent(new i.Event("load")),h.removeEventListener("canplaythrough",u)},!1),h.src=e,h.load(),h.autoplay=!1,h.onerror=function(){var t=new i.Event(i.Event.ERROR);t.message="Cannot load an asset: "+h.src,i.Core.instance.dispatchEvent(t),o.dispatchEvent(t)},o._element=h;else if("audio/mpeg"===n){var c=document.createElement("embed"),l="enchant-audio"+i.Core.instance._soundID++;c.width=c.height=1,c.name=l,c.src="sound.swf?id="+l+"&src="+e,c.allowscriptaccess="always",c.style.position="absolute",c.style.left="-1px",o.addEventListener("load",function(){Object.defineProperties(c,{currentTime:{get:function(){return c.getCurrentTime()},set:function(t){c.setCurrentTime(t)}},volume:{get:function(){return c.getVolume()},set:function(t){c.setVolume(t)}}}),o._element=c,o.duration=c.getDuration()}),i.Core.instance._element.appendChild(c),i.DOMSound[l]=o}else t.setTimeout(function(){o.dispatchEvent(new i.Event("load"))},0);return o},t.AudioContext=t.AudioContext||t.webkitAudioContext||t.mozAudioContext||t.msAudioContext||t.oAudioContext,i.WebAudioSound=i.Class.create(i.EventTarget,{initialize:function(){if(!t.AudioContext)throw Error("This browser does not support WebAudio API.");i.EventTarget.call(this),i.WebAudioSound.audioContext||(i.WebAudioSound.audioContext=new t.AudioContext,i.WebAudioSound.destination=i.WebAudioSound.audioContext.destination),this.context=i.WebAudioSound.audioContext,this.src=this.context.createBufferSource(),this.buffer=null,this._volume=1,this._currentTime=0,this._state=0,this.connectTarget=i.WebAudioSound.destination},play:function(t){1!==this._state||t||this.src.disconnect(),2!==this._state&&(this._currentTime=0);var e=this._currentTime,i=this.context;this.src=i.createBufferSource(),this._gain=null!=i.createGain?i.createGain():i.createGainNode(),this.src.buffer=this.buffer,this._gain.gain.value=this._volume,this.src.connect(this._gain),this._gain.connect(this.connectTarget),null!=this.src.start?this.src.start(0,e,this.buffer.duration-e-1.192e-7):this.src.noteGrainOn(0,e,this.buffer.duration-e-1.192e-7),this._startTime=i.currentTime-this._currentTime,this._state=1},pause:function(){var t=this.currentTime;t!==this.duration&&(null!=this.src.stop?this.src.stop(0):this.src.noteOff(0),this._currentTime=t,this._state=2)},stop:function(){null!=this.src.stop?this.src.stop(0):this.src.noteOff(0),this._state=0},clone:function(){var t=new i.WebAudioSound;return t.buffer=this.buffer,t},duration:{get:function(){return this.buffer?this.buffer.duration:0}},volume:{get:function(){return this._volume},set:function(t){t=Math.max(0,Math.min(1,t)),this._volume=t,this.src&&(this._gain.gain.value=t)}},currentTime:{get:function(){return Math.max(0,Math.min(this.duration,this.src.context.currentTime-this._startTime))},set:function(t){this._currentTime=t,2!==this._state&&this.play(!1)}}}),i.WebAudioSound.load=function(t,e,n,s){function r(){var e=new i.Event(i.Event.ERROR);e.message="Cannot load an asset: "+t,i.Core.instance.dispatchEvent(e),o.dispatchEvent(e)}var a=(new Audio).canPlayType(e),o=new i.WebAudioSound;n=n||function(){},s=s||function(){},o.addEventListener(i.Event.LOAD,n),o.addEventListener(i.Event.ERROR,s);var h,c;return"maybe"===a||"probably"===a?(h=i.WebAudioSound.audioContext,c=new XMLHttpRequest,c.open("GET",t,!0),c.responseType="arraybuffer",c.onload=function(){h.decodeAudioData(c.response,function(t){o.buffer=t,o.dispatchEvent(new i.Event(i.Event.LOAD))},r)},c.onerror=r,c.send(null)):setTimeout(r,50),o},i.Sound=t.AudioContext&&i.ENV.USE_WEBAUDIO?i.WebAudioSound:i.DOMSound,i.Easing={LINEAR:function(t,e,i,n){return i*t/n+e},SWING:function(t,e,i,n){return i*(.5-Math.cos(t/n*Math.PI)/2)+e},QUAD_EASEIN:function(t,e,i,n){return i*(t/=n)*t+e},QUAD_EASEOUT:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},QUAD_EASEINOUT:function(t,e,i,n){return 1>(t/=n/2)?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},CUBIC_EASEIN:function(t,e,i,n){return i*(t/=n)*t*t+e},CUBIC_EASEOUT:function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},CUBIC_EASEINOUT:function(t,e,i,n){return 1>(t/=n/2)?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},QUART_EASEIN:function(t,e,i,n){return i*(t/=n)*t*t*t+e},QUART_EASEOUT:function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},QUART_EASEINOUT:function(t,e,i,n){return 1>(t/=n/2)?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},QUINT_EASEIN:function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},QUINT_EASEOUT:function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},QUINT_EASEINOUT:function(t,e,i,n){return 1>(t/=n/2)?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},SIN_EASEIN:function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},SIN_EASEOUT:function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},SIN_EASEINOUT:function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e},CIRC_EASEIN:function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e},CIRC_EASEOUT:function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e},CIRC_EASEINOUT:function(t,e,i,n){return 1>(t/=n/2)?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},ELASTIC_EASEIN:function(t,e,i,n,s,r){if(0===t)return e;if(1===(t/=n))return e+i;r||(r=.3*n);var a;return!s||Math.abs(i)>s?(s=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/s),-(s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r))+e},ELASTIC_EASEOUT:function(t,e,i,n,s,r){if(0===t)return e;if(1===(t/=n))return e+i;r||(r=.3*n);var a;return!s||Math.abs(i)>s?(s=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/s),s*Math.pow(2,-10*t)*Math.sin(2*(t*n-a)*Math.PI/r)+i+e},ELASTIC_EASEINOUT:function(t,e,i,n,s,r){if(0===t)return e;if(2===(t/=n/2))return e+i;r||(r=.3*n*1.5);var a;return!s||Math.abs(i)>s?(s=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/s),1>t?-.5*s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r)+e:.5*s*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r)+i+e},BOUNCE_EASEOUT:function(t,e,i,n){return 1/2.75>(t/=n)?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},BOUNCE_EASEIN:function(t,e,n,s){return n-i.Easing.BOUNCE_EASEOUT(s-t,0,n,s)+e},BOUNCE_EASEINOUT:function(t,e,n,s){return s/2>t?.5*i.Easing.BOUNCE_EASEIN(2*t,0,n,s)+e:.5*i.Easing.BOUNCE_EASEOUT(2*t-s,0,n,s)+.5*n+e},BACK_EASEIN:function(t,i,n,s,r){return r===e&&(r=1.70158),n*(t/=s)*t*((r+1)*t-r)+i},BACK_EASEOUT:function(t,i,n,s,r){return r===e&&(r=1.70158),n*((t=t/s-1)*t*((r+1)*t+r)+1)+i},BACK_EASEINOUT:function(t,i,n,s,r){return r===e&&(r=1.70158),1>(t/=s/2)?n/2*t*t*(((r*=1.525)+1)*t-r)+i:n/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+i},EXPO_EASEIN:function(t,e,i,n){return 0===t?e:i*Math.pow(2,10*(t/n-1))+e},EXPO_EASEOUT:function(t,e,i,n){return t===n?e+i:i*(-Math.pow(2,-10*t/n)+1)+e},EXPO_EASEINOUT:function(t,e,i,n){return 0===t?e:t===n?e+i:1>(t/=n/2)?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e}},i.ActionEventTarget=i.Class.create(i.EventTarget,{initialize:function(){i.EventTarget.apply(this,arguments)},dispatchEvent:function(t){var e=this.node?this.node:this;t.target=e,t.localX=t.x-e._offsetX,t.localY=t.y-e._offsetY,null!=this["on"+t.type]&&this["on"+t.type].call(e,t);var i=this._listeners[t.type];if(null!=i){i=i.slice();for(var n=0,s=i.length;s>n;n++)i[n].call(e,t)}}}),i.Timeline=i.Class.create(i.EventTarget,{initialize:function(t){i.EventTarget.call(this),this.node=t,this.queue=[],this.paused=!1,this.looped=!1,this.isFrameBased=!0,this._parallel=null,this._activated=!1,this.addEventListener(i.Event.ENTER_FRAME,this._onenterframe);var e=this;this._nodeEventListener=function(t){e.dispatchEvent(t)}},_deactivateTimeline:function(){this._activated&&(this._activated=!1,this.node.removeEventListener("enterframe",this._nodeEventListener))},_activateTimeline:function(){this._activated||this.paused||(this.node.addEventListener("enterframe",this._nodeEventListener),this._activated=!0)},_onenterframe:function(t){this.paused||this.tick(this.isFrameBased?1:t.elapsed)},setFrameBased:function(){this.isFrameBased=!0},setTimeBased:function(){this.isFrameBased=!1},next:function(t){var n,s=this.queue.shift();if(s&&(n=new i.Event("actionend"),n.timeline=this,s.dispatchEvent(n),n=new i.Event("removedfromtimeline"),n.timeline=this,s.dispatchEvent(n),this.looped&&this.add(s)),0===this.queue.length)return this._deactivateTimeline(),e;if(t>0||this.queue[0]&&0===this.queue[0].time){var r=new i.Event("actiontick");r.elapsed=t,r.timeline=this,this.queue[0].dispatchEvent(r)}},tick:function(t){if(this.queue.length>0){var e=this.queue[0];if(0===e.frame){var n;n=new i.Event("actionstart"),n.timeline=this,e.dispatchEvent(n)}var s=new i.Event("actiontick");s.timeline=this,s.elapsed=t,e.dispatchEvent(s)}},add:function(t){this._activateTimeline(),this._parallel?(this._parallel.actions.push(t),this._parallel=null):this.queue.push(t),t.frame=0;var e=new i.Event("addedtotimeline");return e.timeline=this,t.dispatchEvent(e),e=new i.Event("actionadded"),e.action=t,this.dispatchEvent(e),this},action:function(t){return this.add(new i.Action(t))},tween:function(t){return this.add(new i.Tween(t))},clear:function(){var t=new i.Event("removedfromtimeline");t.timeline=this;for(var e=0,n=this.queue.length;n>e;e++)this.queue[e].dispatchEvent(t);return this.queue=[],this._deactivateTimeline(),this},skip:function(t){var e=new i.Event("enterframe");for(this.isFrameBased?e.elapsed=1:(e.elapsed=t,t=1);t--;)this.dispatchEvent(e);return this},pause:function(){return this.paused||(this.paused=!0,this._deactivateTimeline()),this},resume:function(){return this.paused&&(this.paused=!1,this._activateTimeline()),this},loop:function(){return this.looped=!0,this},unloop:function(){return this.looped=!1,this},delay:function(t){return this.action({time:t})},wait:function(){return this},then:function(t){return this.action({onactiontick:function(){t.call(this)},time:0})},exec:function(t){return this.then(t)},cue:function(t){var e=0;for(var i in t)t.hasOwnProperty(i)&&(this.delay(i-e),this.then(t[i]),e=i);return this},repeat:function(t,e){return this.action({onactiontick:function(){t.call(this)},time:e})},and:function(){var t=this.queue.pop();if(t instanceof i.ParallelAction)this._parallel=t,this.queue.push(t);else{var e=new i.ParallelAction;e.actions.push(t),this.queue.push(e),this._parallel=e}return this},or:function(){return this},doAll:function(){return this},waitAll:function(){return this},waitUntil:function(t){return this.action({onactiontick:function(e){t.call(this)&&e.timeline.next()}})},fadeTo:function(t,e,i){return this.tween({opacity:t,time:e,easing:i})},fadeIn:function(t,e){return this.fadeTo(1,t,e)},fadeOut:function(t,e){return this.fadeTo(0,t,e)},moveTo:function(t,e,i,n){return this.tween({x:t,y:e,time:i,easing:n})},moveX:function(t,e,i){return this.tween({x:t,time:e,easing:i})},moveY:function(t,e,i){return this.tween({y:t,time:e,easing:i})},moveBy:function(t,e,i,n){return this.tween({x:function(){return this.x+t},y:function(){return this.y+e},time:i,easing:n})},hide:function(){return this.then(function(){this.opacity=0})},show:function(){return this.then(function(){this.opacity=1})},removeFromScene:function(){return this.then(function(){this.parentNode.removeChild(this)})},scaleTo:function(t,e,i){var n,s;return"number"==typeof i?(n=arguments[0],s=arguments[1],e=arguments[2],i=arguments[3]):n=s=t,this.tween({scaleX:n,scaleY:s,time:e,easing:i})},scaleBy:function(t,e,i){var n,s;return"number"==typeof i?(n=arguments[0],s=arguments[1],e=arguments[2],i=arguments[3]):n=s=t,this.tween({scaleX:function(){return this.scaleX*n},scaleY:function(){return this.scaleY*s},time:e,easing:i})},rotateTo:function(t,e,i){return this.tween({rotation:t,time:e,easing:i})},rotateBy:function(t,e,i){return this.tween({rotation:function(){return this.rotation+t},time:e,easing:i})}}),i.Action=i.Class.create(i.ActionEventTarget,{initialize:function(t){i.ActionEventTarget.call(this),this.time=null,this.frame=0;for(var e in t)t.hasOwnProperty(e)&&null!=t[e]&&(this[e]=t[e]);var n=this;this.timeline=null,this.node=null,this.addEventListener(i.Event.ADDED_TO_TIMELINE,function(t){n.timeline=t.timeline,n.node=t.timeline.node,n.frame=0}),this.addEventListener(i.Event.REMOVED_FROM_TIMELINE,function(){n.timeline=null,n.node=null,n.frame=0}),this.addEventListener(i.Event.ACTION_TICK,function(t){var e=n.time-(n.frame+t.elapsed);null!=n.time&&0>=e?(n.frame=n.time,t.timeline.next(-e)):n.frame+=t.elapsed})}}),i.ParallelAction=i.Class.create(i.Action,{initialize:function(t){i.Action.call(this,t),this.actions=[],this.endedActions=[];var e=this;this.addEventListener(i.Event.ACTION_START,function(t){for(var i=0,n=e.actions.length;n>i;i++)e.actions[i].dispatchEvent(t)}),this.addEventListener(i.Event.ACTION_TICK,function(t){var n,s,r={next:function(){var t=e.actions[n];e.actions.splice(n--,1),s=e.actions.length,e.endedActions.push(t);var r=new i.Event("actionend");r.timeline=this,t.dispatchEvent(r),r=new i.Event("removedfromtimeline"),r.timeline=this,t.dispatchEvent(r)}},a=new i.Event("actiontick");for(a.timeline=r,a.elapsed=t.elapsed,n=0,s=e.actions.length;s>n;n++)e.actions[n].dispatchEvent(a);0===e.actions.length&&t.timeline.next()}),this.addEventListener(i.Event.ADDED_TO_TIMELINE,function(t){for(var i=0,n=e.actions.length;n>i;i++)e.actions[i].dispatchEvent(t)}),this.addEventListener(i.Event.REMOVED_FROM_TIMELINE,function(){e.actions=e.endedActions,e.endedActions=[]})}}),i.Tween=i.Class.create(i.Action,{initialize:function(t){var n={},s={};i.Action.call(this,t),null==this.easing&&(this.easing=i.Easing.LINEAR);var r=this;this.addEventListener(i.Event.ACTION_START,function(){var e=["frame","time","callback","onactiontick","onactionstart","onactionend"];for(var i in t)if(t.hasOwnProperty(i)){var a;a="function"==typeof t[i]?t[i].call(r.node):t[i],-1===e.indexOf(i)&&(n[i]=r.node[i],s[i]=a)}}),this.addEventListener(i.Event.ACTION_TICK,function(t){var i=0===r.time?1:r.easing(Math.min(r.time,r.frame+t.elapsed),0,1,r.time)-r.easing(r.frame,0,1,r.time);for(var a in s)if(s.hasOwnProperty(a)){if(this[a]===e)continue;r.node[a]+=(s[a]-n[a])*i,1e-7>Math.abs(r.node[a])&&(r.node[a]=0)}})}})}(window)},function(t,e){var i={mapData:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],foregroundData:[[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[3,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[3,-1,2,3,3,3,-1,-1,-1,-1,-1,-1,3,3,3,-1,-1,3,3,3,3,3,3,3,3,13],[-1,-1,-1,3,-1,3,-1,-1,-1,3,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,4,-1,-1,-1,-1,-1,-1,-1,-1,15,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,3,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,3,3,3,-1,-1,-1,-1,-1,-1,-1,-1,3,13],[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14]]
};t.exports=i}]);